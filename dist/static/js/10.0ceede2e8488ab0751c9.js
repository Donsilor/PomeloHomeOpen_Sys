webpackJsonp([10],{"++sy":function(e,t,o){"use strict";t.i=function(e){return Object(i.a)({url:"/api2/resources-service/icon/class/add",method:"post",data:e})},t.j=function(e){return Object(i.a)({url:"/api2/resources-service/icon/class/page",method:"post",data:e})},t.k=function(e){return Object(i.a)({url:"/api2/resources-service/icon/class/update",method:"post",data:e})},t.b=function(e){return Object(i.a)({url:"/api2/resources-service/icon/class/delete",method:"get",params:e})},t.c=function(e){return Object(i.a)({url:"/api2/resources-service/icon/details/add",method:"post",data:e})},t.d=function(e){return Object(i.a)({url:"/api2/resources-service/icon/details/page",method:"post",data:e})},t.e=function(e){return Object(i.a)({url:"/api2/resources-service/icon/details/update",method:"post",data:e})},t.h=function(e){return Object(i.a)({url:"/api2/resources-service/icon/details/enable",method:"post",data:e})},t.g=function(e){return Object(i.a)({url:"/api2/resources-service/icon/details/getById",method:"get",params:e})},t.f=function(e){return Object(i.a)({url:"/api2/resources-service/icon/details/delete",method:"get",data:e})},t.a=function(e){return Object(i.a)({url:"/api2/resources-service/icon/details/getByClasses",method:"post",data:e})};var i=o("Vo7i")},"2S+2":function(e,t,o){"use strict";o("woOf");o.d(t,"c",function(){return a}),o.d(t,"d",function(){return r}),o.d(t,"e",function(){return c}),o.d(t,"a",function(){return s}),o.d(t,"b",function(){return d});var i="/api2/category-model-service/v1",n={PRODUCT_SERVICE:"",SHADOW_SERVICE:"",LOG_SERVICE:"",DATA_ANALYSIS_SERVICE:"",OTA_SERVICE:"",SAFETY_SERVICE:"",AUTH_SERVICE:"",RULES_SERVICE:""};var a={THING_MODEL:i+n.PRODUCT_SERVICE+"/modelManage/getThingModel",UNITS:i+n.PRODUCT_SERVICE+"/categoryManage/units",DRAFT_MODEL:i+n.PRODUCT_SERVICE+"/modelManage/getDraftModel",MODEL_VERSIONS:i+n.PRODUCT_SERVICE+"/modelManage/getModelVersions",MODEL:i+n.PRODUCT_SERVICE+"/modelManage/model",PUSLISH_MODEL:i+n.PRODUCT_SERVICE+"/modelManage/publishModel",UPLOAD_PATH:i+n.PRODUCT_SERVICE+"/modelManage/upload"},r={LIST_PRODUCT:i+n.PRODUCT_SERVICE+"/productManage/product/listProduct",PRODUCT_LIST:i+n.PRODUCT_SERVICE+"/productManage/product/list",PRODUCT_STOP:i+n.PRODUCT_SERVICE+"/productManage/product/disable",PRODUCT_START:i+n.PRODUCT_SERVICE+"/productManage/product/enable",PRODUCT_DELETE:i+n.PRODUCT_SERVICE+"/productManage/product/delete",PRODUCT_ADD:i+n.PRODUCT_SERVICE+"/productManage/product/add",CATEGORY_LIST:i+n.PRODUCT_SERVICE+"/categoryManage/category/list",PRODUCT_DETAIL:i+n.PRODUCT_SERVICE+"/productManage/product/details",PRODUCT_EDIT:i+n.PRODUCT_SERVICE+"/productManage/product/edit",PRODUCT_PUBLISH:i+n.PRODUCT_SERVICE+"/productManage/product/publish",PRODUCT_UNPUBLISH:i+n.PRODUCT_SERVICE+"/productManage/product/unPublish",GET_GROUP_CATEGORY:i+n.PRODUCT_SERVICE+"/productManage/signGroup/category",GET_BRAND:i+n.PRODUCT_SERVICE+"/productManage/brand/getAll"},c={TOPIC_LIST:i+n.PRODUCT_SERVICE+"/topicManage/topicList",TOPIC:i+n.PRODUCT_SERVICE+"/topicManage/topic"},s={TOPIC_TYPE:i+"/productManage/script/topicType",DEVICE_NAME:i+"/productManage/script/deviceName",TOPIC_CLASS:i+"/productManage/script/topicClass",QUERY:i+"/scriptManage/script/query",ADD:i+"/scriptManage/script/add",HANDLE:i+"/scriptManage/script/handle"},d={GET_CATEGORY_LIST:i+n.PRODUCT_SERVICE+"/categoryManage/category/list",GET_ALL_CATEGORY:i+n.PRODUCT_SERVICE+"/categoryManage/category/getAllCategoryDetails",DETAIL_CATEGORY:i+n.PRODUCT_SERVICE+"/categoryManage/category/detail",ADD_CATEGORY:i+n.PRODUCT_SERVICE+"/categoryManage/category/add",EDIT_CATEGORY:i+n.PRODUCT_SERVICE+"/categoryManage/category/edit",DELETE_CATEGORY:i+n.PRODUCT_SERVICE+"/categoryManage/category/delete",GET_SUB_CATEGORY_LIST:i+n.PRODUCT_SERVICE+"/categoryManage/subCategory/list",ADD_SUB_CATEGORY:i+n.PRODUCT_SERVICE+"/categoryManage/subCategory/add",EDIT_SUB_CATEGORY:i+n.PRODUCT_SERVICE+"/categoryManage/subCategory/edit",DEL_SUB_CATEGORY:i+n.PRODUCT_SERVICE+"/categoryManage/subCategory/delete",SUB_CATEGORY_DETAIL:i+n.PRODUCT_SERVICE+"/categoryManage/subCategory/detail",BRAND_LIST:i+n.PRODUCT_SERVICE+"/categoryManage/subCategory/getAllBrand",GET_SEC_CATEGORY_LIST:i+n.PRODUCT_SERVICE+"/categoryManage/subCategory/list",ADD_SEC_CATEGORY:i+n.PRODUCT_SERVICE+"/categoryParent/subCategory/save",EDIT_SEC_CATEGORY:i+n.PRODUCT_SERVICE+"/categoryParent/subCategory/update",DEL_SEC_CATEGORY:i+n.PRODUCT_SERVICE+"/categoryParent/subCategory/del",SEC_CATEGORY_DETAIL:i+n.PRODUCT_SERVICE+"/categoryManage/subCategory/detail",UPLOAD:i+n.PRODUCT_SERVICE+"/categoryManage/category/upload",GET_MODEL:i+n.PRODUCT_SERVICE+"/categoryManage/category/getModel",ADD_MODEL:i+n.PRODUCT_SERVICE+"/categoryManage/category/addModel",EDIT_MODEL:i+n.PRODUCT_SERVICE+"/categoryManage/category/editModel",DELETE_MODEL:i+n.PRODUCT_SERVICE+"/categoryManage/category/deleteModel",GET_MODELS:i+n.PRODUCT_SERVICE+"/categoryManage/category/lists",SUB_UPLOAD:i+n.PRODUCT_SERVICE+"/categoryManage/subCategory/upload",SUB_GET_MODEL:i+n.PRODUCT_SERVICE+"/categoryManage/subCategory/getModel",SUB_ADD_MODEL:i+n.PRODUCT_SERVICE+"/categoryManage/subCategory/addModel",SUB_EDIT_MODEL:i+n.PRODUCT_SERVICE+"/categoryManage/subCategory/editModel",SUB_DELETE_MODEL:i+n.PRODUCT_SERVICE+"/categoryManage/subCategory/deleteModel",SUB_GET_MODELS:i+n.PRODUCT_SERVICE+"/categoryManage/subCategory/lists",SEC_UPLOAD:i+n.PRODUCT_SERVICE+"/categoryParent/subCategory/upload",SEC_GET_MODEL:i+n.PRODUCT_SERVICE+"/categoryParent/subCategory/getModel",SEC_ADD_MODEL:i+n.PRODUCT_SERVICE+"/categoryParent/subCategory/addModel",SEC_EDIT_MODEL:i+n.PRODUCT_SERVICE+"/categoryParent/subCategory/editModel",SEC_DELETE_MODEL:i+n.PRODUCT_SERVICE+"/categoryParent/subCategory/deleteModel",SEC_GET_MODELS:i+n.PRODUCT_SERVICE+"/categoryParent/subCategory/lists"}},"76N3":function(e,t,o){var i=o("ePob");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);o("rjj0")("342f962a",i,!0)},E4LH:function(e,t,o){"use strict";t.a=function(e){return/^(\w-*\.*)+@(\w-?)+(\.\w{2,})+$/g.test(e)},t.c=function(e,t,o){var i=!0;if(!t)return void o();for(var n=0;n<t.length;n++){var a=t.charCodeAt(n);if(!(65<=a&&a<=90||97<=a&&a<=122||95==a)){i=!1,o("只能是字母下划线");break}}i&&o()},t.b=function(e,t,o){var i=!0;if(!t)return void o();for(var n=0;n<t.length;n++){var a=t.charAt(n);if(!/[\u4e00-\u9fa5a-zA-Z]+/g.test(a)){i=!1,o("只能是中文字母");break}}i&&o()},t.d=function(e){return/^\d+$/.test(e)},t.e=function(e){return/^[a-zA-Z_\u4e00-\u9fa5][a-zA-Z0-9_\u4e00-\u9fa5]*$/.test(e)}},FOuM:function(e,t,o){"use strict";t.i=function(e){return Object(i.a)({url:"/api2/scene-service/scene_web_type_mgt/list",method:"post",data:e})},t.b=function(e){return Object(i.a)({url:"/api2/scene-service/scene_web_type_mgt/add",method:"post",data:e})},t.f=function(e){return Object(i.a)({url:"/api2/scene-service/scene_web_type_mgt/edit",method:"post",data:e})},t.h=function(e){return Object(i.a)({url:"/api2/scene-service/scene_web_type_mgt/enable",method:"post",data:e})},t.d=function(e){return Object(i.a)({url:"/api2/scene-service/scene_web_type_mgt/delete",method:"post",data:e})},t.j=function(e){return Object(i.a)({url:"/api2/scene-service/scene_web_type_mgt/comboBoxList",method:"post",data:e})},t.k=function(e){return Object(i.a)({url:"/api2/scene-service/scene_web_template_mgt/list",method:"post",data:e})},t.a=function(e){return Object(i.a)({url:"/api2/scene-service/scene_web_template_mgt/add",method:"post",data:e})},t.c=function(e){return Object(i.a)({url:"/api2/scene-service/scene_web_template_mgt/delete",method:"post",data:e})},t.g=function(e){return Object(i.a)({url:"/api2/scene-service/scene_web_template_mgt/enable",method:"post",data:e})},t.l=function(e){return Object(i.a)({url:"/api2/scene-service/scene_web_template_mgt/detail",method:"post",data:e})},t.e=function(e){return Object(i.a)({url:"/api2/scene-service/scene_web_template_mgt/edit",method:"post",data:e})};var i=o("Vo7i")},W0bd:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o("mvHQ"),p=o.n(i),n=o("FOuM"),a=o("E4LH"),u=o("wAEc"),r=o("++sy"),c={props:{addDialogVisible:{type:Boolean,default:!1},editId:{type:Number,default:0},dialogType:{type:Number,default:1}},data:function(){return{loading:!1,total:0,listQuery:{page:1,limit:5},sceneList:[],sceneIcon:[],sceneBackground:[],conditionImgs:[],actionAutoImgs:[],actionManualImgs:[],form:{sort:"",sceneType:1,sceneName:"",sceneBgIconId:"",sceneIconId:"",typeId:"",sceneDesc:"",sceneIntroduce:"",action:[{actionOpType:0,actionType:"",resourceId:"",sort:0,actionProps:[{businessId:"",categoryId:"",categoryName:"",subCategoryName:"",propertyName:"",compareType:"0",compareValue:"",deviceUuid:"",subCategoryId:""}]}],condition:[{conditionOpType:0,conditionType:"",resourceId:"",conditionProps:[{businessId:"",categoryId:"",categoryName:"",subCategoryName:"",propertyName:"",compareType:"",compareValue:"",deviceUuid:"",subCategoryId:""},{propertyName:"",compareType:"",compareValue:""}]}]},modelCondition:[{facilityIcon:[],unFacilityIcon:[],facilityChild:[],brand:[],attribute:[],specs:[],type:"",max:"",min:"",ifShowSpecs:!1,ifShowInput:!1,hasSwitch:!1,comparison:["大于","等于","小于"],executeMode:["指定日期","每周"],weeks:["星期一","星期二","星期三","星期四","星期五","星期六","星期日"],operation:[],autoExecute:[]}],modelAction:[{facilityIcon:[],unFacilityIcon:[],facilityChild:[],brand:[],attribute:[],specs:[],type:"",max:"",min:"",ifShowSpecs:!1,ifShowInput:!1,hasSwitch:!1,comparison:["大于","等于","小于"],operation:[],autoExecute:[]}],sceneType:["手动","自动","安防"],detailsType:["定时","设备","安防"],manualType:["安防","设备"],facility:[],operationCondition:[],operationAction:[],defend:"",condition:9,isToModify:!1,dialogVisible:!1,dialogContent:"",affirmType:2,delId:"",pickerOptions:{disabledDate:function(e){return e<Date.now()-864e5}},formRules:{sort:[{required:!0,validator:function(e,t,o){Object(a.d)(t)?o():o(new Error("请输入正确的序号(正整数)"))},trigger:"blur"}],sceneType:[{required:!0,trigger:"change"}],sceneName:[{required:!0,validator:function(e,t,o){Object(a.e)(t)?o():o(new Error("请输入正确的场景名称"))},trigger:"blur"}],sceneBgIconId:[{required:!0,validator:function(e,t,o){t?o():o(new Error("请选择场景背景"))},trigger:"change"}],sceneIconId:[{required:!0,validator:function(e,t,o){t?o():o(new Error("请选择场景图标"))},trigger:"change"}],typeId:[{required:!0,validator:function(e,t,o){t?o():o(new Error("请选择模板类型"))},trigger:"change"}]}}},created:function(){var t=this;this.getSenceSelect(),this.getSceneImage(),this.getSafety(),Object(u.D)({params:{}}).then(function(e){t.defend=e.data.data.filter(function(e){return 1e4==e.categoryNumber}),t.facility=e.data.data.filter(function(e){return 1e4!=e.categoryNumber}),2!=t.dialogType&&3!=t.dialogType||(t.loading=!0,t.editScene(t.editId))})},methods:{getSafety:function(){var o=this;Object(u.u)({params:{deviceCategoryId:1e4,deviceSubCategoryId:0,key:"",modeType:2,brandId:""}}).then(function(e){if(200==e.data.code){var t=e.data.data.thingModel.properties;o.operationCondition=t.filter(function(e){return 0==e.action||1==e.action}),o.operationAction=t.filter(function(e){return 0==e.action||2==e.action})}})},getSenceSelect:function(){var t=this;Object(n.j)({params:{}}).then(function(e){t.sceneList=e.data})},getCategory:function(){var t=this,e={pageNumber:this.listQuery.page,pageSize:9999,categoryName:""};subCategory({params:e}).then(function(e){t.facility=e.data.data.list})},getSceneImage:function(){var o=this;Object(r.a)({identityNames:["scene_background","scene_icon","trigger_condition_icon","trigger_task_man_icon","trigger_task_auto_icon"]}).then(function(e){var t=e.data;o.sceneBackground=t.scene_background,o.sceneIcon=t.scene_icon,o.conditionImgs=t.trigger_condition_icon,o.actionAutoImgs=t.trigger_task_auto_icon,o.actionManualImgs=t.trigger_task_man_icon})},seleceTouch:function(e,t){this.modelCondition[e].facilityIcon=[],this.modelCondition[e].unFacilityIcon=[];var o="";if(1==t){o="trigger_condition_device";var i={conditionOpType:0,conditionType:t,resourceId:"",conditionProps:[{businessId:"",categoryId:"",categoryName:"",propertyName:"",compareType:"",compareValue:"",deviceUuid:"",subCategoryId:"",subCategoryName:""}]};this.form.condition.splice(e,1,i)}else if(0==t){o="trigger_condition_time";var n={conditionOpType:0,conditionType:t,resourceId:"",conditionProps:[{propertyName:"",compareType:1,compareValue:""},{propertyName:"",compareType:1,compareValue:""}]};this.form.condition.splice(e,1,n)}else if(2==t){o="trigger_condition_safe";var a={conditionOpType:0,conditionType:t,resourceId:"",conditionProps:[{businessId:-1,categoryId:1e4,categoryName:"security",propertyName:"",compareType:1,compareValue:"",deviceUuid:"",subCategoryId:0,subCategoryName:""}]};this.form.condition.splice(e,1,a),this.modelCondition[e].operation=this.operationCondition}if(o){var r="";this.conditionImgs.forEach(function(e){e.classIdentityName==o&&(r=e)}),r&&this.modelCondition[e].unFacilityIcon.push(r)}},seleceExecute:function(e,t){this.modelAction[e].facilityIcon=[],this.modelAction[e].unFacilityIcon=[];var o="";if(1==t){o="trigger_condition_device";var i={actionOpType:0,actionType:t,resourceId:"",sort:0,actionProps:[{businessId:"",categoryId:"",categoryName:"",propertyName:"",compareType:"",compareValue:"",deviceUuid:"",subCategoryId:"",subCategoryName:""}]};this.form.action.splice(e,1,i)}else if(0==t){o="trigger_condition_safe";var n={actionOpType:0,actionType:t,resourceId:"",actionProps:[{businessId:-1,categoryId:1e4,categoryName:"security",propertyName:"",compareType:1,compareValue:"",deviceUuid:"",subCategoryId:0,subCategoryName:""}]};this.form.action.splice(e,1,n),this.modelAction[e].operation=this.operationAction}if(o){var a="";0==this.form.sceneType?this.actionManualImgs.forEach(function(e){e.classIdentityName==o&&(a=e)}):this.actionAutoImgs.forEach(function(e){e.classIdentityName==o&&(a=e)}),a&&this.modelAction[e].unFacilityIcon.push(a)}},changeTimeType:function(e,t){0==t?(this.form.condition[e].conditionProps[0].propertyName=0,this.form.condition[e].conditionProps[0].compareType=1,this.form.condition[e].conditionProps[0].compareValue="",this.form.condition[e].conditionProps[1].propertyName=0,this.form.condition[e].conditionProps[1].compareType=1,this.form.condition[e].conditionProps[1].compareValue=""):(this.form.condition[e].conditionProps[1].propertyName=1,this.form.condition[e].conditionProps[1].compareType=1,this.form.condition[e].conditionProps[1].compareValue=[])},changeCondition:function(o,i){var n=this,a="";this.facility.forEach(function(e,t){e.categoryNumber==i&&(n.form.condition[o].conditionProps[0].categoryName=e.categoryName,a=e.categoryId)}),this.form.condition[o].conditionProps[0].categoryId=i,this.form.condition[o].conditionProps[0].subCategoryId="",this.form.condition[o].conditionProps[0].businessId="",this.form.condition[o].conditionProps[0].deviceUuid="",this.form.condition[o].conditionProps[0].subCategoryName="",this.form.condition[o].conditionProps[0].length=1,this.form.condition[o].conditionProps[0].propertyName="",this.form.condition[o].conditionProps[0].compareType="",this.form.condition[o].conditionProps[0].compareValue="",this.form.condition[o].resourceId="",this.modelCondition[o].facilityChild=[],this.modelCondition[o].attribute=[],this.modelCondition[o].facilityIcon=[],this.modelCondition[o].unFacilityIcon=[],this.modelCondition[o].specs=[],this.modelCondition[o].type="",this.modelCondition[o].max="",this.modelCondition[o].min="",this.modelCondition[o].hasSwitch=!1,this.modelCondition[o].ifShowSpecs=!1,this.modelCondition[o].ifShowInput=!1,this.getModelData("condition",o,i);var e={categoryId:a,subCategoryName:"",pageNumber:this.listQuery.page,pageSize:9999};Object(u.A)({params:e}).then(function(e){200==e.data.code&&(n.modelCondition[o].facilityChild=e.data.data.list)})},changeAction:function(o,i){var n=this,a="";this.facility.forEach(function(e,t){e.categoryNumber==i&&(n.form.action[o].actionProps[0].categoryName=e.categoryName,a=e.categoryId)}),this.form.action[o].actionProps[0].categoryId=i,this.form.action[o].actionProps[0].subCategoryId="",this.form.action[o].actionProps[0].businessId="",this.form.action[o].actionProps[0].deviceUuid="",this.form.action[o].actionProps[0].subCategoryName="",this.form.action[o].actionProps[0].length=1,this.form.action[o].actionProps[0].propertyName="",this.form.action[o].actionProps[0].compareType="",this.form.action[o].actionProps[0].compareValue="",this.form.action[o].resourceId="",this.modelAction[o].facilityChild=[],this.modelAction[o].attribute=[],this.modelAction[o].facilityIcon=[],this.modelAction[o].unFacilityIcon=[],this.modelAction[o].specs=[],this.modelAction[o].type="",this.modelAction[o].max="",this.modelAction[o].min="",this.modelAction[o].hasSwitch=!1,this.modelAction[o].ifShowSpecs=!1,this.modelAction[o].ifShowInput=!1,this.getModelData("action",o,i);var e={categoryId:a,subCategoryName:"",pageNumber:this.listQuery.page,pageSize:9999};Object(u.A)({params:e}).then(function(e){200==e.data.code&&(n.modelAction[o].facilityChild=e.data.data.list)})},getModelData:function(t,o,e){var i=this;if("condition"==t){var n={deviceCategoryId:Number(e),deviceSubCategoryId:0,key:"",modeType:this.form.condition[o].conditionType,brandId:""};e&&Object(u.u)({params:n}).then(function(e){200==e.data.code&&(i.modelCondition[o].attribute=e.data.data.thingModel.properties,i.hasAction(t,o))})}else{var a={deviceCategoryId:Number(e),deviceSubCategoryId:0,key:"",modeType:this.form.action[o].actionType,brandId:""};e&&Object(u.u)({params:a}).then(function(e){200==e.data.code&&(i.modelAction[o].attribute=e.data.data.thingModel.properties,i.hasAction(t,o))})}},getSubModelCondition:function(n,e,o){var a=this,i=0;if(this.modelCondition[n].facilityChild.forEach(function(e,t){e.subCategoryId==o&&(a.form.condition[n].conditionProps[0].subCategoryName=e.subCategoryName,i=e.subCategoryNumber)}),this.form.condition[n].conditionProps[0].businessId="",this.form.condition[n].conditionProps[0].propertyName="",this.form.condition[n].conditionProps[0].compareType="",this.form.condition[n].conditionProps[0].compareValue="",this.form.condition[n].resourceId="",this.modelCondition[n].attribute=[],this.modelCondition[n].facilityIcon=[],this.modelCondition[n].unFacilityIcon=[],this.modelCondition[n].specs=[],this.modelCondition[n].type="",this.modelCondition[n].max="",this.modelCondition[n].min="",this.modelCondition[n].hasSwitch=!1,this.modelCondition[n].ifShowSpecs=!1,this.modelCondition[n].ifShowInput=!1,i){var t={deviceCategoryId:Number(e),deviceSubCategoryId:Number(i),key:"",modeType:this.form.condition[n].conditionType};Object(u.v)({params:t}).then(function(e){200==e.data.code&&(a.modelCondition[n].attribute=e.data.data.thingModel.properties,a.hasAction("condition",n))});var r={categoryId:o,subCategoryName:"",pageNumber:this.listQuery.page,pageSize:9999};Object(u.A)({params:r}).then(function(e){if(200==e.data.code){for(var t=e.data.data.list,o={4:"豪恩",0:"星络",2:"海尔",31:"万和",38:"凯迪士",28:"晾霸",20:"三雄",103:"鸿雁",26:"雷士",33:"TCL",44:"杜亚",24:"万家乐"},i=0;i<t.length;i++)t[i].subCategoryName=o[t[i].brandId];a.modelCondition[n].brand=t}})}},getSubModelAction:function(n,e,o){var a=this,i=0;if(this.modelAction[n].facilityChild.forEach(function(e,t){e.subCategoryId==o&&(a.form.action[n].actionProps[0].subCategoryName=e.subCategoryName,i=e.subCategoryNumber)}),this.form.action[n].actionProps[0].businessId="",this.form.action[n].actionProps[0].propertyName="",this.form.action[n].actionProps[0].compareType="",this.form.action[n].actionProps[0].compareValue="",this.form.action[n].resourceId="",this.modelAction[n].attribute=[],this.modelAction[n].facilityIcon=[],this.modelAction[n].unFacilityIcon=[],this.modelAction[n].specs=[],this.modelAction[n].type="",this.modelAction[n].max="",this.modelAction[n].min="",this.modelAction[n].hasSwitch=!1,this.modelAction[n].ifShowSpecs=!1,this.modelAction[n].ifShowInput=!1,i){var t={deviceCategoryId:Number(e),deviceSubCategoryId:Number(i),key:"",modeType:this.form.action[n].actionType};Object(u.v)({params:t}).then(function(e){200==e.data.code&&(a.modelAction[n].attribute=e.data.data.thingModel.properties,a.hasAction("action",n))});var r={categoryId:o,subCategoryName:"",pageNumber:this.listQuery.page,pageSize:9999};Object(u.A)({params:r}).then(function(e){if(200==e.data.code){for(var t=e.data.data.list,o={4:"豪恩",0:"星络",2:"海尔",31:"万和",38:"凯迪士",28:"晾霸",20:"三雄",103:"鸿雁",26:"雷士",33:"TCL",44:"杜亚",24:"万家乐"},i=0;i<t.length;i++)t[i].subCategoryName=o[t[i].brandId];a.modelAction[n].brand=t}})}},getBrandModelCondition:function(o,e,i,t){var n=this;this.form.condition[o].conditionProps[0].propertyName="",this.form.condition[o].conditionProps[0].compareType="",this.form.condition[o].conditionProps[0].compareValue="",this.form.condition[o].resourceId="",this.modelCondition[o].attribute=[],this.modelCondition[o].facilityIcon=[],this.modelCondition[o].unFacilityIcon=[],this.modelCondition[o].specs=[],this.modelCondition[o].type="",this.modelCondition[o].max="",this.modelCondition[o].min="",this.modelCondition[o].hasSwitch=!1,this.modelCondition[o].ifShowSpecs=!1,this.modelCondition[o].ifShowInput=!1;var a=0;this.modelCondition[o].facilityChild.forEach(function(e,t){e.subCategoryId==i&&(n.form.condition[o].conditionProps[0].subCategoryName=e.subCategoryName,a=e.subCategoryNumber)});var r={deviceCategoryId:Number(e),deviceSubCategoryId:Number(a),key:"",modeType:this.form.condition[o].conditionType,brandId:t};Object(u.w)({params:r}).then(function(e){200==e.data.code&&(n.modelCondition[o].attribute=e.data.data.thingModel.properties,n.hasAction("condition",o))})},getBrandModelAction:function(o,e,i,t){var n=this;this.form.action[o].actionProps[0].propertyName="",this.form.action[o].actionProps[0].compareType="",this.form.action[o].actionProps[0].compareValue="",this.form.action[o].resourceId="",this.modelAction[o].attribute=[],this.modelAction[o].facilityIcon=[],this.modelAction[o].unFacilityIcon=[],this.modelAction[o].specs=[],this.modelAction[o].type="",this.modelAction[o].max="",this.modelAction[o].min="",this.modelAction[o].hasSwitch=!1,this.modelAction[o].ifShowSpecs=!1,this.modelAction[o].ifShowInput=!1;var a=0;this.modelAction[o].facilityChild.forEach(function(e,t){e.subCategoryId==i&&(n.form.action[o].actionProps[0].subCategoryName=e.subCategoryName,a=e.subCategoryNumber)});var r={deviceCategoryId:Number(e),deviceSubCategoryId:Number(a),key:"",modeType:this.form.action[o].actionType,brandId:t};Object(u.w)({params:r}).then(function(e){200==e.data.code&&(n.modelAction[o].attribute=e.data.data.thingModel.properties,n.hasAction("action",o))})},attrType:function(o,e,i){var n=this;e.forEach(function(e,t){"condition"==o?e.identifier==n.form.condition[i].conditionProps[0].propertyName&&(n.modelCondition[i].specs=e.dataType.specs,n.modelCondition[i].type=e.dataType.type,"{}"==p()(n.modelCondition[i].specs)||"enum"!=e.dataType.type&&"bool"!=e.dataType.type?(n.modelCondition[i].ifShowSpecs=!1,n.modelCondition[i].ifShowInput=!0):(n.modelCondition[i].ifShowSpecs=!0,n.modelCondition[i].ifShowInput=!1),"int"==n.modelCondition[i].type&&(n.modelCondition[i].max=e.dataType.specs.max,n.modelCondition[i].min=e.dataType.specs.min)):e.identifier==n.form.action[i].actionProps[0].propertyName&&(n.modelAction[i].specs=e.dataType.specs,n.modelAction[i].type=e.dataType.type,"{}"==p()(n.modelAction[i].specs)||"enum"!=e.dataType.type&&"bool"!=e.dataType.type?(n.modelAction[i].ifShowSpecs=!1,n.modelAction[i].ifShowInput=!0):(n.modelAction[i].ifShowSpecs=!0,n.modelAction[i].ifShowInput=!1),"int"==n.modelAction[i].type&&(n.modelAction[i].max=e.dataType.specs.max,n.modelAction[i].min=e.dataType.specs.min))})},hasAction:function(e,t){var o=[];"condition"==e?(o=this.modelCondition[t].attribute.filter(function(e,t){return 0==e.action||1==e.action}),this.modelCondition[t].attribute=o):(o=this.modelAction[t].attribute.filter(function(e,t){return 0==e.action||2==e.action}),this.modelAction[t].attribute=o),o.some(function(e){return"switch"==e.identifier})&&("condition"==e?this.modelCondition[t].hasSwitch=!0:this.modelAction[t].hasSwitch=!0)},changeAttrCondition:function(o,i){var n=this;this.modelCondition[o].attribute.forEach(function(e,t){e.identifier==i&&(n.modelCondition[o].specs=e.dataType.specs,n.modelCondition[o].type=e.dataType.type,"{}"==p()(n.modelCondition[o].specs)||"enum"!=e.dataType.type&&"bool"!=e.dataType.type?(n.modelCondition[o].ifShowSpecs=!1,n.modelCondition[o].ifShowInput=!0):(n.modelCondition[o].ifShowSpecs=!0,n.modelCondition[o].ifShowInput=!1),"int"==n.modelCondition[o].type&&(n.modelCondition[o].max=e.dataType.specs.max,n.modelCondition[o].min=e.dataType.specs.min))})},changeAttrAction:function(o,i){var n=this;this.modelAction[o].attribute.forEach(function(e,t){e.identifier==i&&(n.modelAction[o].specs=e.dataType.specs,n.modelAction[o].type=e.dataType.type,"{}"==p()(n.modelAction[o].specs)||"enum"!=e.dataType.type&&"bool"!=e.dataType.type?(n.modelAction[o].ifShowSpecs=!1,n.modelAction[o].ifShowInput=!0):(n.modelAction[o].ifShowSpecs=!0,n.modelAction[o].ifShowInput=!1),"int"==n.modelAction[o].type&&(n.modelAction[o].max=e.dataType.specs.max,n.modelAction[o].min=e.dataType.specs.min))})},changeOperation:function(o,e,i){var n=this;"condition"==e?this.modelCondition[o].operation.forEach(function(e,t){e.identifier==i&&(n.modelCondition[o].autoExecute=e.dataType.specs)}):this.modelAction[o].operation.forEach(function(e,t){e.identifier==i&&(n.modelAction[o].autoExecute=e.dataType.specs)})},addCondition:function(e){this.form.condition.splice(e+1,0,{conditionOpType:1,conditionType:"",resourceId:"",conditionProps:[{businessId:"",categoryId:"",propertyName:"",categoryName:"",compareType:"",compareValue:"",deviceUuid:"",subCategoryId:"",subCategoryName:""}]});this.modelCondition.splice(e+1,0,{facilityIcon:[],unFacilityIcon:[],facilityChild:[],brand:[],attribute:[],specs:[],type:"",max:"",min:"",ifShowSpecs:!1,ifShowInput:!1,hasSwitch:!1,comparison:["大于","等于","小于"],executeMode:["指定日期","每周"],weeks:["星期一","星期二","星期三","星期四","星期五","星期六","星期日"],operation:[],autoExecute:[]})},delCondition:function(e){if(!(1<this.form.condition.length))return this.affirmType=2,this.dialogVisible=!0,void(this.dialogContent="别删了，就剩一个了！");this.form.condition.splice(e,1),this.modelCondition.splice(e,1)},addMotion:function(e){this.form.action.splice(e+1,0,{actionOpType:1,actionType:"",resourceId:"",sort:0,actionProps:[{businessId:"",categoryId:"",categoryName:"",propertyName:"",compareType:"",compareValue:"",deviceUuid:"",subCategoryId:"",subCategoryName:""}]});this.modelAction.splice(e+1,0,{facilityIcon:[],unFacilityIcon:[],facilityChild:[],brand:[],attribute:[],specs:[],type:"",max:"",min:"",ifShowSpecs:!1,ifShowInput:!1,hasSwitch:!1,comparison:["大于","等于","小于"],operation:[],autoExecute:[]})},delMotion:function(e){if(!(1<this.form.action.length))return this.affirmType=2,this.dialogVisible=!0,void(this.dialogContent="别删了，就剩一个了！");this.form.action.splice(e,1),this.modelAction.splice(e,1)},editScene:function(e){var l=this,t={id:e};Object(n.l)({params:t}).then(function(e){if(200==e.code){l.loading=!1;var t=e.data;l.form.id=t.id,l.form.sort=t.sort,l.form.sceneName=t.sceneName,l.form.sceneType=Number(t.sceneType),l.form.sceneBgIconId=Number(t.sceneBgIconId),l.form.sceneIconId=Number(t.sceneIconId),l.form.typeId=t.typeId,l.form.sceneDesc=t.sceneDesc,l.form.sceneIntroduce=t.sceneIntroduce,t.condition.length?l.condition=t.condition[0].conditionOpType+"":l.condition=t.action[0].actionOpType+"",l.form.condition=[],l.modelCondition=[];var s=[],d="";t.condition.forEach(function(e,t){s=JSON.parse(e.conditionProps);var o={conditionOpType:0,conditionType:"",resourceId:"",conditionProps:[{businessId:0,categoryId:"",categoryName:"",propertyName:"",compareType:"",compareValue:"",deviceUuid:"",subCategoryId:0,subCategoryName:""},{propertyName:"",compareType:"",compareValue:""}]},i={facilityIcon:[],unFacilityIcon:[],facilityChild:[],attribute:[],specs:[],type:"",max:"",min:"",ifShowSpecs:!1,ifShowInput:!1,hasSwitch:!1,comparison:["大于","等于","小于"],executeMode:["指定日期","每周"],weeks:["星期一","星期二","星期三","星期四","星期五","星期六","星期日"],operation:[],autoExecute:[]};if(0==e.conditionType){d="trigger_condition_time";var n="";switch(s[1].propertyName){case"appoint_date":n=0;break;case"weeks":n=1}if(o={conditionOpType:e.conditionOpType,conditionType:e.conditionType,resourceId:Number(e.resourceId),conditionProps:[{propertyName:n,compareType:1,compareValue:s[0].compareValue},{propertyName:n,compareType:1,compareValue:s[1].compareValue}]},"weeks"==s[1].propertyName){var a=s[1].compareValue.split(",");a.forEach(function(e,t){return a[t]=Number(e)}),o.conditionProps[1].compareValue=a}}else if(1==e.conditionType){d="trigger_condition_device",2==s.length&&(i.hasSwitch=!0,s.splice(0,1)),o={conditionOpType:e.conditionOpType,conditionType:e.conditionType,resourceId:e.resourceId,conditionProps:[{businessId:-1!=s[0].businessId?Number(s[0].businessId):"",categoryId:Number(s[0].categoryId),categoryName:s[0].categoryName,subCategoryName:s[0].subCategoryName,propertyName:s[0].propertyName,compareType:"",compareValue:s[0].compareValue,deviceUuid:s[0].deviceUuid,subCategoryId:s[0].subCategoryId?Number(s[0].subCategoryId):""}]};var r=1;switch(s[0].compareType){case"<":r=2;break;case"==":r=1;break;case">":r=0}o.conditionProps[0].compareType=r}else 2==e.conditionType&&(d="trigger_condition_safe",o={conditionOpType:e.conditionOpType,conditionType:e.conditionType,resourceId:e.resourceId,conditionProps:[{propertyName:s[0].propertyName,compareType:1,compareValue:s[0].compareValue}]},i.operation=l.operationCondition,i.operation.forEach(function(e){e.identifier==s[0].propertyName&&(i.autoExecute=e.dataType.specs)}));if(l.form.condition.push(o),l.modelCondition.push(i),d){var c="";l.conditionImgs.forEach(function(e){e.classIdentityName==d&&(c=e)}),c&&l.modelCondition[t].unFacilityIcon.push(c)}}),l.form.condition.forEach(function(s,d){if(1==s.conditionType){var o="";l.facility.forEach(function(e,t){e.categoryNumber==s.conditionProps[0].categoryId&&(o=e.categoryId)});var e={categoryId:o,subCategoryName:"",pageNumber:l.listQuery.page,pageSize:9999};Object(u.A)({params:e}).then(function(e){if(200==e.data.code){l.modelCondition[d].facilityChild=e.data.data.list;var t=s.conditionProps[0].subCategoryId,o="";if(l.modelCondition[d].facilityChild.forEach(function(e){e.subCategoryNumber==t&&(o=e.subCategoryId,l.form.condition[d].conditionProps[0].subCategoryId=o)}),""!==s.conditionProps[0].businessId){var i={categoryId:o,subCategoryName:"",pageNumber:l.listQuery.page,pageSize:9999};Object(u.A)({params:i}).then(function(e){if(200==e.data.code){for(var t=e.data.data.list,o={4:"豪恩",0:"星络",2:"海尔",31:"万和",38:"凯迪士",28:"晾霸",20:"三雄",103:"鸿雁",26:"雷士",33:"TCL",44:"杜亚",24:"万家乐"},i=0;i<t.length;i++)t[i].subCategoryName=o[t[i].brandId];l.modelCondition[d].brand=t}});var n={deviceCategoryId:Number(s.conditionProps[0].categoryId),deviceSubCategoryId:Number(t),key:"",modeType:l.form.condition[d].conditionType,brandId:s.conditionProps[0].businessId};Object(u.w)({params:n}).then(function(e){200==e.data.code&&(l.modelCondition[d].attribute=e.data.data.thingModel.properties,l.attrType("condition",l.modelCondition[d].attribute,d),l.hasAction("condition",d))})}else if(t){var a={categoryId:o,subCategoryName:"",pageNumber:l.listQuery.page,pageSize:9999};Object(u.A)({params:a}).then(function(e){if(200==e.data.code){for(var t=e.data.data.list,o={4:"豪恩",0:"星络",2:"海尔",31:"万和",38:"凯迪士",28:"晾霸",20:"三雄",103:"鸿雁",26:"雷士",33:"TCL",44:"杜亚",24:"万家乐"},i=0;i<t.length;i++)t[i].subCategoryName=o[t[i].brandId];l.modelCondition[d].brand=t}});var r={deviceCategoryId:Number(s.conditionProps[0].categoryId),deviceSubCategoryId:Number(t),key:"",modeType:l.form.condition[d].conditionType};Object(u.v)({params:r}).then(function(e){200==e.data.code&&(l.modelCondition[d].attribute=e.data.data.thingModel.properties,l.attrType("condition",l.modelCondition[d].attribute,d),l.hasAction("condition",d))})}else{var c={deviceCategoryId:Number(s.conditionProps[0].categoryId),deviceSubCategoryId:0,key:"",modeType:l.form.condition[d].conditionType,brandId:""};Object(u.u)({params:c}).then(function(e){200==e.data.code&&(l.modelCondition[d].attribute=e.data.data.thingModel.properties,l.attrType("condition",l.modelCondition[d].attribute,d),l.hasAction("condition",d))})}}})}}),l.form.action=[],l.modelAction=[];var r=[];d="";t.action.forEach(function(e,t){r=JSON.parse(e.actionProps);var o={actionOpType:0,actionType:"",resourceId:"",sort:0,actionProps:[{businessId:"",categoryId:"",categoryName:"",subCategoryName:"",propertyName:"",compareType:"0",compareValue:"",deviceUuid:"",subCategoryId:""}]},i={facilityIcon:[],unFacilityIcon:[],facilityChild:[],attribute:[],specs:[],type:"",max:"",min:"",ifShowSpecs:!1,ifShowInput:!1,hasSwitch:!1,comparison:["大于","等于","小于"],operation:[],autoExecute:[]};if(0==e.actionType)d="trigger_condition_safe",o={actionOpType:e.actionOpType,actionType:e.actionType,resourceId:Number(e.resourceId),actionProps:[{propertyName:r[0].propertyName,compareType:1,compareValue:r[0].compareValue}]},i.operation=l.operationAction,i.operation.forEach(function(e){e.identifier==r[0].propertyName&&(i.autoExecute=e.dataType.specs)});else if(1==e.actionType){d="trigger_condition_device",2==r.length&&(i.hasSwitch=!0,r.splice(0,1)),o={actionOpType:e.actionOpType,actionType:e.actionType,resourceId:e.resourceId,sort:0,actionProps:[{businessId:-1!=r[0].businessId?r[0].businessId:"",categoryId:Number(r[0].categoryId),categoryName:r[0].categoryName,subCategoryName:r[0].subCategoryName,propertyName:r[0].propertyName,compareType:"",compareValue:r[0].compareValue,deviceUuid:r[0].deviceUuid,subCategoryId:r[0].subCategoryId?Number(r[0].subCategoryId):""}]};var n=1;switch(r[0].compareType){case"<":n=2;break;case"==":n=1;break;case">":n=0}o.actionProps[0].compareType=n}if(l.form.action.push(o),l.modelAction.push(i),d){var a="";0==l.form.sceneType?l.actionManualImgs.forEach(function(e){e.classIdentityName==d&&(a=e)}):l.actionAutoImgs.forEach(function(e){e.classIdentityName==d&&(a=e)}),a&&l.modelAction[t].unFacilityIcon.push(a)}}),l.form.action.forEach(function(s,d){if(1==s.actionType){var t="";l.facility.forEach(function(e){e.categoryNumber==s.actionProps[0].categoryId&&(t=e.categoryId)});var e={categoryId:t,subCategoryName:"",pageNumber:l.listQuery.page,pageSize:9999};Object(u.A)({params:e}).then(function(e){if(200==e.data.code){l.modelAction[d].facilityChild=e.data.data.list;var t=s.actionProps[0].subCategoryId,o="";if(l.modelAction[d].facilityChild.forEach(function(e){e.subCategoryNumber==t&&(o=e.subCategoryId,l.form.action[d].actionProps[0].subCategoryId=o)}),""!==s.actionProps[0].businessId){var i={categoryId:o,subCategoryName:"",pageNumber:l.listQuery.page,pageSize:9999};Object(u.A)({params:i}).then(function(e){if(200==e.data.code){for(var t=e.data.data.list,o={4:"豪恩",0:"星络",2:"海尔",31:"万和",38:"凯迪士",28:"晾霸",20:"三雄",103:"鸿雁",26:"雷士",33:"TCL",44:"杜亚",24:"万家乐"},i=0;i<t.length;i++)t[i].subCategoryName=o[t[i].brandId];l.modelAction[d].brand=t}});var n={deviceCategoryId:Number(s.actionProps[0].categoryId),deviceSubCategoryId:Number(t),key:"",modeType:l.form.action[d].actionType,brandId:s.actionProps[0].businessId};Object(u.w)({params:n}).then(function(e){200==e.data.code&&(l.modelAction[d].attribute=e.data.data.thingModel.properties,l.attrType("action",l.modelAction[d].attribute,d),l.hasAction("action",d))})}else if(t){var a={categoryId:o,subCategoryName:"",pageNumber:l.listQuery.page,pageSize:9999};Object(u.A)({params:a}).then(function(e){if(200==e.data.code){for(var t=e.data.data.list,o={4:"豪恩",0:"星络",2:"海尔",31:"万和",38:"凯迪士",28:"晾霸",20:"三雄",103:"鸿雁",26:"雷士",33:"TCL",44:"杜亚",24:"万家乐"},i=0;i<t.length;i++)t[i].subCategoryName=o[t[i].brandId];l.modelAction[d].brand=t}});var r={deviceCategoryId:Number(s.actionProps[0].categoryId),deviceSubCategoryId:Number(t),key:"",modeType:l.form.action[d].actionType};Object(u.v)({params:r}).then(function(e){200==e.data.code&&(l.modelAction[d].attribute=e.data.data.thingModel.properties,l.attrType("action",l.modelAction[d].attribute,d),l.hasAction("action",d))})}else{var c={deviceCategoryId:Number(s.actionProps[0].categoryId),deviceSubCategoryId:0,key:"",modeType:l.form.action[d].actionType,brandId:""};Object(u.u)({params:c}).then(function(e){200==e.data.code&&(l.modelAction[d].attribute=e.data.data.thingModel.properties,l.attrType("action",l.modelAction[d].attribute,d),l.hasAction("action",d))})}}})}})}else l.loading=!1})},addOrEdit:function(){var t=this;2!=this.dialogType?this.$refs.permissionForm.validate(function(e){if(!e)return!1;t.dealWithForm()}):this.resetForm()},dealWithForm:function(){if(1==this.form.sceneType)for(var e=this.form.condition,t=0;t<e.length;t++){var o=e[t];if(this.affirmType=2,""===o.conditionType)return this.dialogVisible=!0,void(this.dialogContent="“触发条件"+(1+t)+"”未选择触发条件，请选择！");if(1===o.conditionType&&""===o.conditionProps[0].categoryId)return this.dialogVisible=!0,void(this.dialogContent="“触发条件"+(1+t)+"”未选择大品类设备，请选择！");if(1!=o.conditionType&&""===o.resourceId)return this.dialogVisible=!0,void(this.dialogContent="“触发条件"+(1+t)+"”的图片不能为空，请选择！");if(""===o.conditionProps[0].propertyName)return this.dialogVisible=!0,void(this.dialogContent="“触发条件"+(1+t)+"”的属性不能为空，请选择！");if(""===o.conditionProps[0].compareType)return this.dialogVisible=!0,void(this.dialogContent="“触发条件"+(1+t)+"”的比较值不能为空，请选择！");if(""===o.conditionProps[0].compareValue)return this.dialogVisible=!0,void(this.dialogContent="“触发条件"+(1+t)+"”的属性值不能为空，请选择或填写！");if(0==o.conditionType&&""===o.conditionProps[1].propertyName)return this.dialogVisible=!0,void(this.dialogContent="“触发条件"+(1+t)+"”的属性二不能为空，请选择！");if(0==o.conditionType&&""===o.conditionProps[1].compareType)return this.dialogVisible=!0,void(this.dialogContent="“触发条件"+(1+t)+"”的比较值二不能为空，请选择！");if(0==o.conditionType&&"weeks"!=o.conditionProps[1].propertyName&&""===o.conditionProps[1].compareValue)return this.dialogVisible=!0,void(this.dialogContent="“触发条件"+(1+t)+"”的属性值二不能为空，请选择或填写！");if(0==o.conditionType&&"weeks"==o.conditionProps[1].propertyName&&!o.conditionProps[1].compareValue.length)return this.dialogVisible=!0,void(this.dialogContent="“触发条件"+(1+t)+"”的属性值二不能为空，请选择或填写！");if("int"===this.modelCondition[t].type&&(o.conditionProps[0].compareValue-this.modelCondition[t].min<0||0<o.conditionProps[0].compareValue-this.modelCondition[t].max))return this.dialogVisible=!0,void(this.dialogContent="“触发条件"+(1+t)+"”的属性值取值范围不对，请重新填写（提示："+this.modelCondition[t].min+" - "+this.modelCondition[t].max+"）！")}var i=this.form.action;for(t=0;t<i.length;t++){if((o=i[t]).actionOpType=0,this.affirmType=2,""===o.actionType)return this.dialogVisible=!0,void(this.dialogContent="“执行动作"+(1+t)+"”未选择执行动作，请选择！");if(1===o.actionType&&""===o.actionProps[0].categoryId)return this.dialogVisible=!0,void(this.dialogContent="“执行动作"+(1+t)+"”未选择大品类设备，请选择！");if(0===o.actionType&&""===o.resourceId)return this.dialogVisible=!0,void(this.dialogContent="“执行动作"+(1+t)+"”的图片不能为空，请重新选择！");if(""===o.actionProps[0].propertyName)return this.dialogVisible=!0,void(this.dialogContent="“执行动作"+(1+t)+"”的属性不能为空，请重新选择！");if(""===o.actionProps[0].compareType)return this.dialogVisible=!0,void(this.dialogContent="“执行动作"+(1+t)+"”的比较值不能为空，请重新选择！");if(""===o.actionProps[0].compareValue)return this.dialogVisible=!0,void(this.dialogContent="“执行动作"+(1+t)+"”的属性值不能为空，请重新选择或填写！");if("int"===this.modelAction[t].type&&(o.actionProps[0].compareValue-this.modelAction[t].min<0||0<o.actionProps[0].compareValue-this.modelAction[t].max))return this.dialogVisible=!0,void(this.dialogContent="“执行动作"+(1+t)+"”的属性值取值范围不对，请重新填写（提示："+this.modelAction[t].min+" - "+this.modelAction[t].max+"）！")}if(1==this.form.sceneType)if(9==this.condition)this.form.condition.every(function(e){return 1==e.conditionType})?(this.affirmType=2,this.dialogVisible=!0,this.dialogContent="请选择触发条件关系"):(this.affirmType=3,this.dialogVisible=!0,this.dialogContent="触发条件不可以与");else if(1==this.condition){this.form.condition.every(function(e){return 1==e.conditionType})?this.addSwitch():(this.affirmType=3,this.dialogVisible=!0,this.dialogContent="触发条件不可以与")}else this.addSwitch();else this.addSwitch()},addSwitch:function(){for(var o={params:JSON.parse(p()(this.form))},i={businessId:-1,categoryId:"",categoryName:"",subCategoryName:"",deviceUuid:"",subCategoryId:"",propertyName:"switch",compareType:"==",compareValue:"1"},e=0,t=o.params.condition;e<t.length;e++){var n="";switch(t[e].conditionProps[0].compareType){case 0:n=">";break;case 1:n="==";break;case 2:n="<"}t[e].conditionProps[0].compareType=n,0===t[e].conditionType&&0==t[e].conditionProps[1].propertyName&&(t[e].conditionProps[1].compareType="==",t[e].conditionProps[0].propertyName="appoint_time",t[e].conditionProps[1].propertyName="appoint_date"),0===t[e].conditionType&&1==t[e].conditionProps[1].propertyName&&(t[e].conditionProps[1].compareType="==",t[e].conditionProps[0].propertyName="appoint_time",t[e].conditionProps[1].propertyName="weeks",t[e].conditionProps[1].compareValue=t[e].conditionProps[1].compareValue.join()),1===t[e].conditionType&&""===t[e].conditionProps[0].subCategoryId&&(t[e].conditionProps[0].subCategoryId=0),1===t[e].conditionType&&""===t[e].conditionProps[0].businessId&&(t[e].conditionProps[0].businessId=-1);for(var a=0,r=this.modelCondition[e].facilityChild;a<r.length;a++)r[a].subCategoryId==t[e].conditionProps[0].subCategoryId&&(t[e].conditionProps[0].subCategoryId=r[a].subCategoryNumber)}e=0;for(var c=o.params.action;e<c.length;e++){var s="";switch(c[e].actionProps[0].compareType){case 0:s=">";break;case 1:s="==";break;case 2:s="<"}c[e].actionProps[0].compareType=s,1===c[e].actionType&&""===c[e].actionProps[0].subCategoryId&&(c[e].actionProps[0].subCategoryId=0),1===c[e].actionType&&""===c[e].actionProps[0].businessId&&(c[e].actionProps[0].businessId=-1);for(var d=0,l=this.modelAction[e].facilityChild;d<l.length;d++)l[d].subCategoryId==c[e].actionProps[0].subCategoryId&&(c[e].actionProps[0].subCategoryId=l[d].subCategoryNumber)}this.modelAction.forEach(function(e,t){e.hasSwitch&&"switch"!=o.params.action[t].actionProps[0].propertyName&&(i.businessId=o.params.action[t].actionProps[0].businessId,i.categoryId=o.params.action[t].actionProps[0].categoryId,i.categoryName=o.params.action[t].actionProps[0].categoryName,i.subCategoryName=o.params.action[t].actionProps[0].subCategoryName,i.deviceUuid=o.params.action[t].actionProps[0].deviceUuid,i.subCategoryId=o.params.action[t].actionProps[0].subCategoryId,o.params.action[t].actionProps.unshift(i))})},addTemplate:function(e){var t=this;Object(n.a)(e).then(function(e){200==e.code&&(t.$message.success("新增成功"),t.$emit("closeAddDialog",1))})},editTemplate:function(e){var t=this;Object(n.e)(e).then(function(e){200==e.code&&(t.$message.success("编辑成功"),t.$emit("closeAddDialog",1))})},confirmDelete:function(){this.dialogVisible=!1,3==this.affirmType&&(this.condition="0")},resetForm:function(){this.$emit("closeAddDialog")}}},s={render:function(){var i=this,e=i.$createElement,n=i._self._c||e;return n("div",[n("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:i.loading,expression:"loading"}],staticClass:"doc-dialog",attrs:{center:"",width:"720px",title:1==i.dialogType?"创建模板":2==i.dialogType?"查看模板":"编辑模板",visible:i.addDialogVisible,"before-close":i.resetForm,"element-loading-text":"正在加载···"},on:{"update:visible":function(e){i.addDialogVisible=e}}},[n("el-form",{ref:"permissionForm",attrs:{model:i.form,"label-width":"90px",disabled:2==i.dialogType,"label-position":"left",rules:i.formRules}},[n("el-form-item",{attrs:{label:"场景序号",prop:"sort"}},[n("el-input",{attrs:{type:"number",placeholder:"请输入序号"},model:{value:i.form.sort,callback:function(e){i.$set(i.form,"sort",e)},expression:"form.sort"}})],1),i._v(" "),n("el-form-item",{attrs:{label:"场景类型",prop:"sceneType"}},[n("el-select",{staticClass:"width540",attrs:{placeholder:"请选择类型"},model:{value:i.form.sceneType,callback:function(e){i.$set(i.form,"sceneType",e)},expression:"form.sceneType"}},i._l(i.sceneType,function(e,t){return n("el-option",{key:t,attrs:{label:e,value:t}})}),1)],1),i._v(" "),n("el-form-item",{attrs:{label:"场景名称",prop:"sceneName"}},[n("el-input",{attrs:{readonly:!!i.isToModify,placeholder:"请输入场景名称"},model:{value:i.form.sceneName,callback:function(e){i.$set(i.form,"sceneName",e)},expression:"form.sceneName"}})],1),i._v(" "),n("el-form-item",{attrs:{label:"场景背景",prop:"sceneBgIconId"}},[n("el-select",{staticClass:"dialog_select width540",attrs:{"popper-append-to-body":!1,placeholder:"请选择背景"},model:{value:i.form.sceneBgIconId,callback:function(e){i.$set(i.form,"sceneBgIconId",e)},expression:"form.sceneBgIconId"}},i._l(i.sceneBackground,function(e,t){return n("el-option",{key:t,attrs:{label:e.displayName,value:e.id}},[n("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:e.fileUrl,fit:"fit"}})],1)}),1)],1),i._v(" "),n("el-form-item",{attrs:{label:"场景图标",prop:"sceneIconId"}},[n("el-select",{staticClass:"dialog_select width540",attrs:{"popper-append-to-body":!1,placeholder:"请选择图标"},model:{value:i.form.sceneIconId,callback:function(e){i.$set(i.form,"sceneIconId",e)},expression:"form.sceneIconId"}},i._l(i.sceneIcon,function(e,t){return n("el-option",{key:t,attrs:{label:e.displayName,value:e.id}},[n("el-image",{staticStyle:{width:"100%",height:"100%"},attrs:{src:e.fileUrl,fit:"fit"}})],1)}),1)],1),i._v(" "),n("el-form-item",{attrs:{label:"模板类型",prop:"typeId"}},[n("el-select",{staticClass:"width540",attrs:{"popper-append-to-body":!1,placeholder:"请选择模板类型"},model:{value:i.form.typeId,callback:function(e){i.$set(i.form,"typeId",e)},expression:"form.typeId"}},i._l(i.sceneList,function(e,t){return n("el-option",{key:t,attrs:{label:e.typeName,value:e.id}})}),1)],1),i._v(" "),n("el-form-item",{attrs:{label:"简介",prop:"sceneDesc"}},[n("el-input",{attrs:{placeholder:"简介"},model:{value:i.form.sceneDesc,callback:function(e){i.$set(i.form,"sceneDesc",e)},expression:"form.sceneDesc"}})],1),i._v(" "),n("el-form-item",{attrs:{label:"详细介绍",prop:"sceneIntroduce"}},[n("el-input",{attrs:{placeholder:"详细介绍"},model:{value:i.form.sceneIntroduce,callback:function(e){i.$set(i.form,"sceneIntroduce",e)},expression:"form.sceneIntroduce"}})],1),i._v(" "),n("div",{staticClass:"scene_details"},[n("div",{staticClass:"name"},[i._v("场景详情")]),i._v(" "),n("div",{staticClass:"content"},["1"==i.form.sceneType?n("div",{staticClass:"relation"},[n("el-radio",{attrs:{label:"0"},model:{value:i.condition,callback:function(e){i.condition=e},expression:"condition"}},[i._v("满足任意关系时")]),i._v(" "),n("el-radio",{attrs:{label:"1"},model:{value:i.condition,callback:function(e){i.condition=e},expression:"condition"}},[i._v("满足全部关系时")])],1):i._e(),i._v(" "),"1"==i.form.sceneType?n("div",i._l(i.form.condition,function(t,o){return n("div",{key:o+"a",staticClass:"trigger"},[n("el-row",{staticClass:"trigger_row"},[n("el-col",{attrs:{span:19}},[n("div",[n("span",{staticClass:"star"},[i._v("*")]),i._v("触发条件"+i._s(+o+1))]),i._v(" "),n("div",{staticStyle:{"margin-top":"4px"}},[n("el-select",{attrs:{placeholder:"请选择触发条件"},on:{change:function(e){return i.seleceTouch(o,t.conditionType)}},model:{value:t.conditionType,callback:function(e){i.$set(t,"conditionType",e)},expression:"item.conditionType"}},i._l(i.detailsType,function(e,t){return n("el-option",{key:t,attrs:{label:e,value:t}})}),1),i._v(" "),0===t.conditionType||2===t.conditionType?n("el-select",{staticClass:"dialog_select position position_left",attrs:{"popper-append-to-body":!1,placeholder:"请选择背景"},model:{value:t.resourceId,callback:function(e){i.$set(t,"resourceId",e)},expression:"item.resourceId"}},i._l(i.modelCondition[o].unFacilityIcon,function(e,t){return n("el-option",{key:t,attrs:{label:e.displayName,value:e.id}},[n("el-image",{staticStyle:{width:"100%",height:"100%"},attrs:{src:e.fileUrl,fit:"fit"}})],1)}),1):i._e(),i._v(" "),1===t.conditionType?n("el-select",{attrs:{placeholder:"请选择大品类"},on:{change:function(e){return i.changeCondition(o,t.conditionProps[0].categoryId)}},model:{value:t.conditionProps[0].categoryId,callback:function(e){i.$set(t.conditionProps[0],"categoryId",e)},expression:"item.conditionProps[0].categoryId"}},i._l(i.facility,function(e,t){return n("el-option",{key:t,attrs:{label:e.categoryName,value:e.categoryNumber}})}),1):i._e(),i._v(" "),1===t.conditionType?n("el-select",{attrs:{placeholder:"请选择子品类"},on:{change:function(e){return i.getSubModelCondition(o,t.conditionProps[0].categoryId,t.conditionProps[0].subCategoryId)}},model:{value:t.conditionProps[0].subCategoryId,callback:function(e){i.$set(t.conditionProps[0],"subCategoryId",e)},expression:"item.conditionProps[0].subCategoryId"}},i._l(i.modelCondition[o].facilityChild,function(e,t){return n("el-option",{key:t,attrs:{label:e.subCategoryName,value:e.subCategoryId}})}),1):i._e(),i._v(" "),1===t.conditionType&&t.conditionProps[0].subCategoryId?n("el-select",{attrs:{placeholder:"请选择品牌"},on:{change:function(e){return i.getBrandModelCondition(o,t.conditionProps[0].categoryId,t.conditionProps[0].subCategoryId,t.conditionProps[0].businessId)}},model:{value:t.conditionProps[0].businessId,callback:function(e){i.$set(t.conditionProps[0],"businessId",e)},expression:"item.conditionProps[0].businessId"}},i._l(i.modelCondition[o].brand,function(e,t){return n("el-option",{key:t,attrs:{label:e.subCategoryName,value:e.brandId}})}),1):i._e(),i._v(" "),1===t.conditionType?n("el-select",{attrs:{placeholder:"请选择属性"},on:{change:function(e){return i.changeAttrCondition(o,t.conditionProps[0].propertyName)}},model:{value:t.conditionProps[0].propertyName,callback:function(e){i.$set(t.conditionProps[0],"propertyName",e)},expression:"item.conditionProps[0].propertyName"}},i._l(i.modelCondition[o].attribute,function(e,t){return n("el-option",{key:t,attrs:{label:e.name,value:e.identifier}})}),1):i._e(),i._v(" "),1===t.conditionType?n("el-select",{attrs:{placeholder:"请选择比较值"},model:{value:t.conditionProps[0].compareType,callback:function(e){i.$set(t.conditionProps[0],"compareType",e)},expression:"item.conditionProps[0].compareType"}},i._l(i.modelCondition[o].comparison,function(e,t){return n("el-option",{key:t,attrs:{label:e,value:t}})}),1):i._e(),i._v(" "),1===t.conditionType&&i.modelCondition[o].ifShowSpecs?n("el-select",{attrs:{placeholder:"请选择属性值"},model:{value:t.conditionProps[0].compareValue,callback:function(e){i.$set(t.conditionProps[0],"compareValue",e)},expression:"item.conditionProps[0].compareValue"}},i._l(i.modelCondition[o].specs,function(e,t){return n("el-option",{key:t,attrs:{label:e,value:t}})}),1):i._e(),i._v(" "),1===t.conditionType&&i.modelCondition[o].ifShowInput?n("el-input",{staticClass:"width200",attrs:{placeholder:"请输入内容"},model:{value:t.conditionProps[0].compareValue,callback:function(e){i.$set(t.conditionProps[0],"compareValue",e)},expression:"item.conditionProps[0].compareValue"}}):i._e(),i._v(" "),0===t.conditionType?n("el-select",{attrs:{placeholder:"请选择执行方式"},on:{change:function(e){return i.changeTimeType(o,t.conditionProps[0].propertyName)}},model:{value:t.conditionProps[0].propertyName,callback:function(e){i.$set(t.conditionProps[0],"propertyName",e)},expression:"item.conditionProps[0].propertyName"}},i._l(i.modelCondition[o].executeMode,function(e,t){return n("el-option",{key:t,attrs:{label:e,value:t}})}),1):i._e(),i._v(" "),0===t.conditionType?n("el-time-picker",{staticClass:"width200",attrs:{"arrow-control":"",format:"HH:mm","value-format":"HH:mm","picker-options":{selectableRange:"00:00:00 - 23:59:00"},placeholder:"请选择时间"},model:{value:t.conditionProps[0].compareValue,callback:function(e){i.$set(t.conditionProps[0],"compareValue",e)},expression:"item.conditionProps[0].compareValue"}}):i._e(),i._v(" "),0===t.conditionType&&0===t.conditionProps[0].propertyName?n("el-date-picker",{staticClass:"width200",attrs:{type:"date","picker-options":i.pickerOptions,"value-format":"yyyy-MM-dd",placeholder:"请选择日期"},model:{value:t.conditionProps[1].compareValue,callback:function(e){i.$set(t.conditionProps[1],"compareValue",e)},expression:"item.conditionProps[1].compareValue"}}):i._e(),i._v(" "),0===t.conditionType&&1===t.conditionProps[0].propertyName?n("el-checkbox-group",{model:{value:t.conditionProps[1].compareValue,callback:function(e){i.$set(t.conditionProps[1],"compareValue",e)},expression:"item.conditionProps[1].compareValue"}},i._l(i.modelCondition[o].weeks,function(e,t){return n("el-checkbox",{key:t,attrs:{label:t}},[i._v(i._s(e))])}),1):i._e(),i._v(" "),2===t.conditionType?n("el-select",{attrs:{placeholder:"请选择安防"},on:{change:function(e){return i.changeOperation(o,"condition",t.conditionProps[0].propertyName)}},model:{value:t.conditionProps[0].propertyName,callback:function(e){i.$set(t.conditionProps[0],"propertyName",e)},expression:"item.conditionProps[0].propertyName"}},i._l(i.modelCondition[o].operation,function(e,t){return n("el-option",{key:t,attrs:{label:e.name,value:e.identifier}})}),1):i._e(),i._v(" "),2===t.conditionType?n("el-select",{attrs:{placeholder:"请选择操作"},model:{value:t.conditionProps[0].compareValue,callback:function(e){i.$set(t.conditionProps[0],"compareValue",e)},expression:"item.conditionProps[0].compareValue"}},i._l(i.modelCondition[o].autoExecute,function(e,t){return n("el-option",{key:t,attrs:{label:e,value:t}})}),1):i._e()],1)]),i._v(" "),n("el-col",{staticStyle:{height:"100%",display:"flex","justify-content":"center","align-items":"center"},attrs:{span:4,offset:1}},[n("el-button",{attrs:{type:"success",icon:"el-icon-plus",circle:""},on:{click:function(e){return i.addCondition(o)}}}),i._v(" "),n("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(e){return i.delCondition(o)}}})],1)],1)],1)}),0):i._e(),i._v(" "),i._l(i.form.action,function(t,o){return n("div",{key:o+"b",staticClass:"trigger"},[n("el-row",{staticClass:"trigger_row"},[n("el-col",{attrs:{span:19}},[n("div",[n("span",{staticClass:"star"},[i._v("*")]),i._v("执行动作"+i._s(+o+1))]),i._v(" "),n("div",{staticStyle:{"margin-top":"4px"}},[n("el-select",{attrs:{placeholder:"请选择执行动作"},on:{change:function(e){return i.seleceExecute(o,t.actionType)}},model:{value:t.actionType,callback:function(e){i.$set(t,"actionType",e)},expression:"item.actionType"}},i._l(i.manualType,function(e,t){return n("el-option",{key:t,attrs:{label:e,value:t}})}),1),i._v(" "),0===t.actionType?n("el-select",{staticClass:"dialog_select position position_left",attrs:{"popper-append-to-body":!1,placeholder:"请选择背景"},model:{value:t.resourceId,callback:function(e){i.$set(t,"resourceId",e)},expression:"item.resourceId"}},i._l(i.modelAction[o].unFacilityIcon,function(e,t){return n("el-option",{key:t,attrs:{label:e.displayName,value:e.id}},[n("el-image",{staticStyle:{width:"100%",height:"100%"},attrs:{src:e.fileUrl,fit:"fit"}})],1)}),1):i._e(),i._v(" "),1===t.actionType?n("el-select",{attrs:{placeholder:"请选择大品类"},on:{change:function(e){return i.changeAction(o,t.actionProps[0].categoryId)}},model:{value:t.actionProps[0].categoryId,callback:function(e){i.$set(t.actionProps[0],"categoryId",e)},expression:"item.actionProps[0].categoryId"}},i._l(i.facility,function(e,t){return n("el-option",{key:t,attrs:{label:e.categoryName,value:e.categoryNumber}})}),1):i._e(),i._v(" "),1===t.actionType?n("el-select",{attrs:{placeholder:"请选择子品类"},on:{change:function(e){return i.getSubModelAction(o,t.actionProps[0].categoryId,t.actionProps[0].subCategoryId)}},model:{value:t.actionProps[0].subCategoryId,callback:function(e){i.$set(t.actionProps[0],"subCategoryId",e)},expression:"item.actionProps[0].subCategoryId"}},i._l(i.modelAction[o].facilityChild,function(e,t){return n("el-option",{key:t,attrs:{label:e.subCategoryName,value:e.subCategoryId}})}),1):i._e(),i._v(" "),1===t.actionType&&t.actionProps[0].subCategoryId?n("el-select",{attrs:{placeholder:"请选择品牌"},on:{change:function(e){return i.getBrandModelAction(o,t.actionProps[0].categoryId,t.actionProps[0].subCategoryId,t.actionProps[0].businessId)}},model:{value:t.actionProps[0].businessId,callback:function(e){i.$set(t.actionProps[0],"businessId",e)},expression:"item.actionProps[0].businessId"}},i._l(i.modelAction[o].brand,function(e,t){return n("el-option",{key:t,attrs:{label:e.subCategoryName,value:e.brandId}})}),1):i._e(),i._v(" "),1===t.actionType?n("el-select",{attrs:{placeholder:"请选择属性"},on:{change:function(e){return i.changeAttrAction(o,t.actionProps[0].propertyName)}},model:{value:t.actionProps[0].propertyName,callback:function(e){i.$set(t.actionProps[0],"propertyName",e)},expression:"item.actionProps[0].propertyName"}},i._l(i.modelAction[o].attribute,function(e,t){return n("el-option",{key:t,attrs:{label:e.name,value:e.identifier}})}),1):i._e(),i._v(" "),1===t.actionType?n("el-select",{attrs:{placeholder:"请选择比较值"},model:{value:t.actionProps[0].compareType,callback:function(e){i.$set(t.actionProps[0],"compareType",e)},expression:"item.actionProps[0].compareType"}},i._l(i.modelAction[o].comparison,function(e,t){return n("el-option",{key:t,attrs:{label:e,value:t}})}),1):i._e(),i._v(" "),1===t.actionType&&i.modelAction[o].ifShowSpecs?n("el-select",{attrs:{placeholder:"请选择属性值"},model:{value:t.actionProps[0].compareValue,callback:function(e){i.$set(t.actionProps[0],"compareValue",e)},expression:"item.actionProps[0].compareValue"}},i._l(i.modelAction[o].specs,function(e,t){return n("el-option",{key:t,attrs:{label:e,value:t}})}),1):i._e(),i._v(" "),1===t.actionType&&i.modelAction[o].ifShowInput?n("el-input",{staticClass:"width200",attrs:{placeholder:"请输入内容"},model:{value:t.actionProps[0].compareValue,callback:function(e){i.$set(t.actionProps[0],"compareValue",e)},expression:"item.actionProps[0].compareValue"}}):i._e(),i._v(" "),0===t.actionType?n("el-select",{attrs:{placeholder:"请选择安防"},on:{change:function(e){return i.changeOperation(o,"action",t.actionProps[0].propertyName)}},model:{value:t.actionProps[0].propertyName,callback:function(e){i.$set(t.actionProps[0],"propertyName",e)},expression:"item.actionProps[0].propertyName"}},i._l(i.modelAction[o].operation,function(e,t){return n("el-option",{key:t,attrs:{label:e.name,value:e.identifier}})}),1):i._e(),i._v(" "),0===t.actionType?n("el-select",{attrs:{placeholder:"请选择操作"},model:{value:t.actionProps[0].compareValue,callback:function(e){i.$set(t.actionProps[0],"compareValue",e)},expression:"item.actionProps[0].compareValue"}},i._l(i.modelAction[o].autoExecute,function(e,t){return n("el-option",{key:t,attrs:{label:e,value:t}})}),1):i._e()],1)]),i._v(" "),n("el-col",{staticClass:"btn",attrs:{span:4,offset:1}},[n("el-button",{attrs:{type:"success",icon:"el-icon-plus",circle:""},on:{click:function(e){return i.addMotion(o)}}}),i._v(" "),n("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(e){return i.delMotion(o)}}})],1)],1)],1)})],2)])],1),i._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[2!=i.dialogType?n("el-button",{on:{click:i.resetForm}},[i._v("取 消")]):i._e(),i._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:i.addOrEdit}},[i._v(i._s(i.isToModify?"保存修改":"确 定"))])],1)],1),i._v(" "),n("el-dialog",{attrs:{title:"提示",visible:i.dialogVisible,width:"30%"},on:{"update:visible":function(e){i.dialogVisible=e}}},[n("span",[i._v(i._s(i.dialogContent))]),i._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){i.dialogVisible=!1}}},[i._v("取 消")]),i._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(e){return i.confirmDelete()}}},[i._v("确 定")])],1)])],1)},staticRenderFns:[]};var d={components:{AddDialog:o("VU/8")(c,s,!1,function(e){o("76N3")},"data-v-c1a03bcc",null).exports,Paging:o("prc4").a},data:function(){return{searchVal:"",tableData:[],addDialogVisible:!1,dialogType:1,editId:0,listLoading:!1,dialogVisible:!1,delId:"",total:0,listQuery:{page:1,limit:15},acellStyle:{"text-align":"center"},headCellStyle:{"text-align":"center","font-weight":"bold","font-size":"17px",color:"black","background-color":"#f4f5f7"}}},created:function(){this.getList()},methods:{handleSizeChange:function(e){this.listQuery.page=1,this.listQuery.limit=e,this.getList()},handleCurrentChange:function(e){this.listQuery.page=1,this.listQuery.limit=e,this.getList()},search:function(){this.getList(this.searchVal)},getList:function(e){var i=this,t={pageNumber:this.listQuery.page,pageSize:this.listQuery.limit,sceneName:e||""};Object(n.k)({params:t}).then(function(e){var t=e.data;i.total=t.total;var o=JSON.parse(p()(t.list));o.forEach(function(e,t){2==e.sceneType?o[t].ifShowBtn=!1:o[t].ifShowBtn=!0}),i.tableData=o})},createdTemplate:function(){this.editId=0,this.dialogType=1,this.addDialogVisible=!0},openDialog:function(e,t){this.editId=t,this.dialogType=e,this.addDialogVisible=!0},ifEnable:function(e){var t=this,o={id:e.id,isEnable:e.isEnable?0:1};Object(n.g)({params:o}).then(function(e){200==e.code&&(t.$message({type:"success",message:"修改成功!"}),t.getList())})},deleteFault:function(e){this.dialogVisible=!0,this.delId=e},confirmDelete:function(){var t=this,e={id:this.delId};Object(n.c)({params:e}).then(function(e){200==e.code&&(t.dialogVisible=!1,t.getList())})},closeAddDialog:function(e){this.addDialogVisible=!1,e&&this.getList()},changePage:function(e){this.listQuery=e,this.getList()}}},l={render:function(){var o=this,e=o.$createElement,i=o._self._c||e;return i("div",{staticClass:"app-container"},[i("el-row",{staticClass:"product-menu"},[i("el-col",[i("el-button",{staticClass:"first-btn",attrs:{type:"primary"},on:{click:function(e){return o.createdTemplate(1)}}},[o._v("创建模板")])],1),o._v(" "),i("el-col",{attrs:{span:12}},[i("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入模板名称"},nativeOn:{keyup:function(e){return"keyCode"in e&&o._k(e.keyCode,"enter",13,e.key,"Enter")?null:o.search(e)}},model:{value:o.searchVal,callback:function(e){o.searchVal=e},expression:"searchVal"}},[i("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:o.search},slot:"append"})],1)],1)],1),o._v(" "),i("el-table",{staticStyle:{width:"100%"},attrs:{data:o.tableData,"cell-style":o.acellStyle,"header-cell-style":o.headCellStyle,border:"","tooltip-effect":"dark"}},[i("el-table-column",{attrs:{align:"center",label:"序号",prop:"sort"}}),o._v(" "),i("el-table-column",{attrs:{align:"center",label:"触发类型",prop:""},scopedSlots:o._u([{key:"default",fn:function(e){return[i("div",[o._v(o._s(0==e.row.sceneType?"手动":1==e.row.sceneType?"自动":"安防"))])]}}])}),o._v(" "),i("el-table-column",{attrs:{align:"center",label:"模板名称",prop:"sceneName"}}),o._v(" "),i("el-table-column",{attrs:{align:"center",label:"模板类型",prop:"typeName"}}),o._v(" "),i("el-table-column",{attrs:{align:"center",label:"模板简介",prop:"sceneDesc"}}),o._v(" "),i("el-table-column",{attrs:{align:"center",label:"创建时间",prop:"createdTime"}}),o._v(" "),i("el-table-column",{attrs:{align:"center",label:"修改时间",prop:"updatedTime"}}),o._v(" "),i("el-table-column",{attrs:{align:"center",label:"状态"},scopedSlots:o._u([{key:"default",fn:function(e){return[e.row.isEnable?i("el-tag",{attrs:{type:"info"}},[o._v("已禁用")]):i("el-tag",{attrs:{type:"success"}},[o._v("已启用")])]}}])}),o._v(" "),i("el-table-column",{attrs:{align:"center",label:"操作",width:"320"},scopedSlots:o._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return o.openDialog(o.type=2,t.row.id)}}},[o._v("查看")]),o._v(" "),t.row.ifShowBtn?i("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return o.openDialog(o.type=3,t.row.id)}}},[o._v("编辑")]):i("el-button",{attrs:{size:"small",type:"info",disabled:""}},[o._v("编辑")]),o._v(" "),t.row.isEnable?i("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return o.ifEnable(t.row)}}},[o._v("启用")]):i("el-button",{attrs:{size:"small",type:"warning"},on:{click:function(e){return o.ifEnable(t.row)}}},[o._v("禁用")]),o._v(" "),t.row.ifShowBtn?i("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(e){return o.deleteFault(t.row.id)}}},[o._v("删除")]):i("el-button",{attrs:{size:"small",type:"info",disabled:""}},[o._v("删除")])]}}])})],1),o._v(" "),i("el-dialog",{attrs:{title:"提示",visible:o.dialogVisible,width:"30%"},on:{"update:visible":function(e){o.dialogVisible=e}}},[i("span",[o._v("是否确认删除这条模板信息？")]),o._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){o.dialogVisible=!1}}},[o._v("取 消")]),o._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return o.confirmDelete()}}},[o._v("确 定")])],1)]),o._v(" "),o.addDialogVisible?i("AddDialog",{attrs:{"add-dialog-visible":o.addDialogVisible,"edit-id":o.editId,dialogType:o.dialogType},on:{closeAddDialog:o.closeAddDialog}}):o._e(),o._v(" "),i("Paging",{attrs:{total:o.total,pageQuery:o.listQuery},on:{changePage:o.changePage}})],1)},staticRenderFns:[]};var m=o("VU/8")(d,l,!1,function(e){o("w5E2")},"data-v-0ce1a3f1",null);t.default=m.exports},XcuW:function(e,t,o){(e.exports=o("FZ+f")(!0)).push([e.i,".pagination-container[data-v-0ec775e4]{margin-top:10px}","",{version:3,sources:["D:/Product/PomeloHomeOpen_Sys/src/components/paging.vue"],names:[],mappings:"AACA,uCACE,eAAiB,CAClB",file:"paging.vue",sourcesContent:["\n.pagination-container[data-v-0ec775e4] {\n  margin-top: 10px;\n}\n"],sourceRoot:""}])},ePob:function(e,t,o){(e.exports=o("FZ+f")(!0)).push([e.i,".doc-dialog .el-form-item[data-v-c1a03bcc]{margin-bottom:20px}.doc-dialog .scene_details .name[data-v-c1a03bcc]{width:64px;margin-bottom:14px}.doc-dialog .scene_details .content[data-v-c1a03bcc]{padding-left:40px;line-height:30px;margin-bottom:10px}.doc-dialog .scene_details .content .relation[data-v-c1a03bcc]{margin-bottom:14px}.doc-dialog .scene_details .content .tip[data-v-c1a03bcc]{display:inline-block;padding-right:30px;cursor:pointer}.doc-dialog .scene_details .content .trigger[data-v-c1a03bcc]{display:-webkit-box;display:-ms-flexbox;display:flex;min-height:96px;padding:6px 10px 10px;background:#eee;margin-bottom:10px}.doc-dialog .scene_details .content .trigger .trigger_row[data-v-c1a03bcc]{width:100%}.doc-dialog .scene_details .content .trigger .btn[data-v-c1a03bcc]{height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.width200[data-v-c1a03bcc]{width:200px}.dialog_select.width540[data-v-c1a03bcc] .el-select-dropdown,.width540[data-v-c1a03bcc]{width:540px}.dialog_select[data-v-c1a03bcc] .el-select-dropdown__list{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;padding:10px}.dialog_select[data-v-c1a03bcc] .el-select-dropdown__item{width:60px;height:60px;padding:0}.dialog_select[data-v-c1a03bcc] .el-select-dropdown__item:not(:nth-child(7n)){margin-right:16px}.dialog_select[data-v-c1a03bcc] .el-select-dropdown__item:nth-child(n+8){margin-top:10px}.dialog_select[data-v-c1a03bcc] .el-scrollbar__bar{display:none}.position[data-v-c1a03bcc] .el-select-dropdown{width:400px}.position[data-v-c1a03bcc] .el-select-dropdown /deep/ .el-select-dropdown__item{margin-top:0}.position[data-v-c1a03bcc] .el-select-dropdown /deep/ .el-select-dropdown__item:nth-child(n+6){margin-top:10px}.position[data-v-c1a03bcc] .el-select-dropdown /deep/ .popper__arrow{left:226px!important}.position_left[data-v-c1a03bcc] .el-select-dropdown{-webkit-transform:translateX(-200px);transform:translateX(-200px)}.star[data-v-c1a03bcc]{color:red;margin-right:4px}","",{version:3,sources:["D:/Product/PomeloHomeOpen_Sys/src/components/ruleEngine/template/addDialog.vue"],names:[],mappings:"AACA,2CACE,kBAAoB,CACrB,AACD,kDACE,WAAY,AACZ,kBAAoB,CACrB,AACD,qDACE,kBAAmB,AACnB,iBAAkB,AAClB,kBAAoB,CACrB,AACD,+DACI,kBAAoB,CACvB,AACD,0DACI,qBAAsB,AACtB,mBAAoB,AACpB,cAAgB,CACnB,AACD,8DACI,oBAAqB,AACrB,oBAAqB,AACrB,aAAc,AACd,gBAAiB,AACjB,sBAAuB,AACvB,gBAAiB,AACjB,kBAAoB,CACvB,AACD,2EACM,UAAY,CACjB,AACD,mEACM,YAAa,AACb,oBAAqB,AACrB,oBAAqB,AACrB,aAAc,AACd,wBAAyB,AACrB,qBAAsB,AAClB,uBAAwB,AAChC,yBAA0B,AACtB,sBAAuB,AACnB,kBAAoB,CACjC,AACD,2BACE,WAAa,CACd,AAID,wFACE,WAAa,CACd,AACD,0DACE,oBAAqB,AACrB,oBAAqB,AACrB,aAAc,AACd,mBAAoB,AAChB,eAAgB,AACpB,YAAc,CACf,AACD,0DACE,WAAY,AACZ,YAAa,AACb,SAAW,CACZ,AACD,8EACE,iBAAmB,CACpB,AACD,yEACE,eAAiB,CAClB,AACD,mDACE,YAAc,CACf,AACD,+CACE,WAAa,CACd,AACD,gFACI,YAAc,CACjB,AACD,+FACI,eAAiB,CACpB,AACD,qEACI,oBAAuB,CAC1B,AACD,oDACE,qCAAsC,AAC9B,4BAA8B,CACvC,AACD,uBACE,UAAW,AACX,gBAAkB,CACnB",file:"addDialog.vue",sourcesContent:["\n.doc-dialog .el-form-item[data-v-c1a03bcc] {\n  margin-bottom: 20px;\n}\n.doc-dialog .scene_details .name[data-v-c1a03bcc] {\n  width: 64px;\n  margin-bottom: 14px;\n}\n.doc-dialog .scene_details .content[data-v-c1a03bcc] {\n  padding-left: 40px;\n  line-height: 30px;\n  margin-bottom: 10px;\n}\n.doc-dialog .scene_details .content .relation[data-v-c1a03bcc] {\n    margin-bottom: 14px;\n}\n.doc-dialog .scene_details .content .tip[data-v-c1a03bcc] {\n    display: inline-block;\n    padding-right: 30px;\n    cursor: pointer;\n}\n.doc-dialog .scene_details .content .trigger[data-v-c1a03bcc] {\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    min-height: 96px;\n    padding: 6px 10px 10px;\n    background: #eee;\n    margin-bottom: 10px;\n}\n.doc-dialog .scene_details .content .trigger .trigger_row[data-v-c1a03bcc] {\n      width: 100%;\n}\n.doc-dialog .scene_details .content .trigger .btn[data-v-c1a03bcc] {\n      height: 100%;\n      display: -webkit-box;\n      display: -ms-flexbox;\n      display: flex;\n      -webkit-box-pack: center;\n          -ms-flex-pack: center;\n              justify-content: center;\n      -webkit-box-align: center;\n          -ms-flex-align: center;\n              align-items: center;\n}\n.width200[data-v-c1a03bcc] {\n  width: 200px;\n}\n.width540[data-v-c1a03bcc] {\n  width: 540px;\n}\n.dialog_select.width540[data-v-c1a03bcc] .el-select-dropdown {\n  width: 540px;\n}\n.dialog_select[data-v-c1a03bcc] .el-select-dropdown__list {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -ms-flex-wrap: wrap;\n      flex-wrap: wrap;\n  padding: 10px;\n}\n.dialog_select[data-v-c1a03bcc] .el-select-dropdown__item {\n  width: 60px;\n  height: 60px;\n  padding: 0;\n}\n.dialog_select[data-v-c1a03bcc] .el-select-dropdown__item:not(:nth-child(7n)) {\n  margin-right: 16px;\n}\n.dialog_select[data-v-c1a03bcc] .el-select-dropdown__item:nth-child(n+8) {\n  margin-top: 10px;\n}\n.dialog_select[data-v-c1a03bcc] .el-scrollbar__bar {\n  display: none;\n}\n.position[data-v-c1a03bcc] .el-select-dropdown {\n  width: 400px;\n}\n.position[data-v-c1a03bcc] .el-select-dropdown /deep/ .el-select-dropdown__item {\n    margin-top: 0;\n}\n.position[data-v-c1a03bcc] .el-select-dropdown /deep/ .el-select-dropdown__item:nth-child(n+6) {\n    margin-top: 10px;\n}\n.position[data-v-c1a03bcc] .el-select-dropdown /deep/ .popper__arrow {\n    left: 226px !important;\n}\n.position_left[data-v-c1a03bcc] .el-select-dropdown {\n  -webkit-transform: translateX(-200px);\n          transform: translateX(-200px);\n}\n.star[data-v-c1a03bcc] {\n  color: red;\n  margin-right: 4px;\n}\n"],sourceRoot:""}])},fAK7:function(e,t,o){(e.exports=o("FZ+f")(!0)).push([e.i,".product-menu[data-v-0ce1a3f1]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;margin-bottom:30px}.product-menu .showOnline[data-v-0ce1a3f1]{margin-right:20px}.product-menu .is-justify-end[data-v-0ce1a3f1]{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.product-menu .left span[data-v-0ce1a3f1]{margin-right:20px;font-size:20px;font-weight:600}.product-menu .left .first-btn[data-v-0ce1a3f1]{margin-right:10px}.product-menu .left .refalsh[data-v-0ce1a3f1]{margin-right:20px}","",{version:3,sources:["D:/Product/PomeloHomeOpen_Sys/src/views/ruleEngine/template.vue"],names:[],mappings:"AACA,+BACE,oBAAqB,AACrB,oBAAqB,AACrB,aAAc,AACd,yBAA0B,AACtB,sBAAuB,AACnB,8BAA+B,AACvC,kBAAoB,CACrB,AACD,2CACI,iBAAmB,CACtB,AACD,+CACI,yBAA0B,AACtB,sBAAuB,AACnB,kBAAoB,CAC/B,AACD,0CACI,kBAAmB,AACnB,eAAgB,AAChB,eAAiB,CACpB,AACD,gDACI,iBAAmB,CACtB,AACD,8CACI,iBAAmB,CACtB",file:"template.vue",sourcesContent:["\n.product-menu[data-v-0ce1a3f1] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: justify;\n      -ms-flex-pack: justify;\n          justify-content: space-between;\n  margin-bottom: 30px;\n}\n.product-menu .showOnline[data-v-0ce1a3f1] {\n    margin-right: 20px;\n}\n.product-menu .is-justify-end[data-v-0ce1a3f1] {\n    -webkit-box-align: center;\n        -ms-flex-align: center;\n            align-items: center;\n}\n.product-menu .left span[data-v-0ce1a3f1] {\n    margin-right: 20px;\n    font-size: 20px;\n    font-weight: 600;\n}\n.product-menu .left .first-btn[data-v-0ce1a3f1] {\n    margin-right: 10px;\n}\n.product-menu .left .refalsh[data-v-0ce1a3f1] {\n    margin-right: 20px;\n}\n"],sourceRoot:""}])},prc4:function(e,t,o){"use strict";var i={props:{total:{type:Number,default:0},pagingStatus:{type:String,default:""},pageSize:{type:Array||null,default:function(){return[5,15,20,30,50]}},pageQuery:{type:Object||null,default:function(){return{page:1,limit:5}}}},data:function(){return{layout:this.pagingStatus?"sizes, total, prev, pager, next ":"total, sizes, prev, pager, next, jumper",pageStatus:this.pagingStatus?[5,10]:[5,15,20,30,50],listLoading:!1,listQuery:this.pageQuery?this.pageQuery:{page:1,limit:5}}},watch:{total:{handler:function(e){this.listLoading=!e},immediate:!0}},created:function(){},methods:{handleSizeChange:function(e){this.listQuery.page=1,this.listQuery.limit=e,this.$emit("changePage",this.listQuery)},handleCurrentChange:function(e){this.listQuery.page=e,this.$emit("changePage",this.listQuery)}}},n={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("el-row",{directives:[{name:"show",rawName:"v-show",value:!t.listLoading,expression:"!listLoading"}],staticClass:"pagination-container",attrs:{type:"flex",justify:"end"}},[o("el-pagination",{attrs:{small:!!t.pagingStatus,"current-page":t.listQuery.page,"page-sizes":t.pageSize?t.pageSize:t.pageStatus,"page-size":t.listQuery.limit,total:t.total,layout:t.layout},on:{"update:currentPage":function(e){return t.$set(t.listQuery,"page",e)},"update:current-page":function(e){return t.$set(t.listQuery,"page",e)},"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)},staticRenderFns:[]};var a=o("VU/8")(i,n,!1,function(e){o("vRIc")},"data-v-0ec775e4",null);t.a=a.exports},vRIc:function(e,t,o){var i=o("XcuW");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);o("rjj0")("3dd58aeb",i,!0)},w5E2:function(e,t,o){var i=o("fAK7");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);o("rjj0")("7785583a",i,!0)},wAEc:function(e,t,o){"use strict";t.D=function(e){return Object(i.a)({url:n.b.GET_ALL_CATEGORY,method:"post",data:e})},t.E=function(e){return Object(i.a)({url:n.b.GET_CATEGORY_LIST,method:"post",data:e})},t.n=function(e){return Object(i.a)({url:n.b.DETAIL_CATEGORY,method:"post",data:e})},t.e=function(e){return Object(i.a)({url:n.b.ADD_CATEGORY,method:"post",data:e})},t.s=function(e){return Object(i.a)({url:n.b.EDIT_CATEGORY,method:"post",data:e})},t.m=function(e){return Object(i.a)({url:n.b.DELETE_CATEGORY,method:"post",data:e})},t.x=function(e){return Object(i.a)({url:n.b.GET_SEC_CATEGORY_LIST,method:"post",data:e})},t.a=function(e){return Object(i.a)({url:n.b.ADD_SEC_CATEGORY,method:"post",data:e})},t.o=function(e){return Object(i.a)({url:n.b.EDIT_SEC_CATEGORY,method:"post",data:e})},t.i=function(e){return Object(i.a)({url:n.b.DEL_SEC_CATEGORY,method:"post",data:e})},t.y=function(e){return Object(i.a)({url:n.b.SEC_CATEGORY_DETAIL,method:"post",data:e})},t.A=function(e){return Object(i.a)({url:n.b.GET_SUB_CATEGORY_LIST,method:"post",data:e})},t.c=function(e){return Object(i.a)({url:n.b.ADD_SUB_CATEGORY,method:"post",data:e})},t.q=function(e){return Object(i.a)({url:n.b.EDIT_SUB_CATEGORY,method:"post",data:e})},t.k=function(e){return Object(i.a)({url:n.b.DEL_SUB_CATEGORY,method:"post",data:e})},t.B=function(e){return Object(i.a)({url:n.b.SUB_CATEGORY_DETAIL,method:"post",data:e})},t.g=function(e){return Object(i.a)({url:n.b.BRAND_LIST,method:"post",data:e})},t.F=function(e){return Object(i.a)({url:n.b.UPLOAD,method:"post",data:e})},t.u=function(e){return Object(i.a)({url:n.b.GET_MODEL,method:"post",data:e})},t.f=function(e){return Object(i.a)({url:n.b.ADD_MODEL,method:"post",data:e})},t.t=function(e){return Object(i.a)({url:n.b.EDIT_MODEL,method:"post",data:e})},t.h=function(e){return Object(i.a)({url:n.b.DELETE_MODEL,method:"post",data:e})},t.C=function(e){return Object(i.a)({url:n.b.SUB_UPLOAD,method:"post",data:e})},t.w=function(e){return Object(i.a)({url:n.b.SUB_GET_MODEL,method:"post",data:e})},t.d=function(e){return Object(i.a)({url:n.b.SUB_ADD_MODEL,method:"post",data:e})},t.r=function(e){return Object(i.a)({url:n.b.SUB_EDIT_MODEL,method:"post",data:e})},t.l=function(e){return Object(i.a)({url:n.b.SUB_DELETE_MODEL,method:"post",data:e})},t.z=function(e){return Object(i.a)({url:n.b.SEC_UPLOAD,method:"post",data:e})},t.v=function(e){return Object(i.a)({url:n.b.SEC_GET_MODEL,method:"post",data:e})},t.b=function(e){return Object(i.a)({url:n.b.SEC_ADD_MODEL,method:"post",data:e})},t.p=function(e){return Object(i.a)({url:n.b.SEC_EDIT_MODEL,method:"post",data:e})},t.j=function(e){return Object(i.a)({url:n.b.SEC_DELETE_MODEL,method:"post",data:e})};var i=o("Vo7i"),n=o("2S+2")}});