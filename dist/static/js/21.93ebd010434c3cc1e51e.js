webpackJsonp([21],{"C+Vd":function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o("woOf"),r=o.n(a),s=(o("zL8q"),o("Vo7i")),n=(o("VSB1"),o("TIfe")),i=o("E4LH"),l={name:"ChannelDetail",components:{},data:function(){return{isEdit:!!this.$route.query.id,token:Object(n.b)(),isLoadData:!1,hasProduct:!1,editText:"编辑渠道商信息",disabled:!!this.$route.query.id,id:this.$route.query.id?this.$route.query.id:"",form:{sort:"",id:this.$route.query.id,name:"",name_e:"",logo:{id:"",type:27,object:"",filename:"",url:"",md5:""},qrcode:{id:"",type:28,object:"",filename:"",url:"",md5:""},is_third:1,third_info:""},rules:{name:[{required:!0,message:"请输入渠道商名称",trigger:"blur"},{max:32,message:"渠道商名称不能超过32个字符",trigger:"blur"},{validator:i.b}],name_e:[{required:!0,message:"请输入渠道商英文",trigger:"blur"},{max:32,message:"渠道商英文不能超过32个字符",trigger:"blur"},{validator:i.c}]},logo:{token:Object(n.b)(),type:27},qrcode:{token:Object(n.b)(),type:28}}},computed:{},created:function(){this.isEdit&&this.getChannelInfo()},mounted:function(){},methods:{radioChange:function(){this.form.third_info=""},getChannelInfo:function(){var t=this;Object(s.a)({url:"/distributor/info",method:"post",data:{id:this.$route.query.id}}).then(function(e){t.form.name=e.name,t.form.sort=e.sort,t.form.name_e=e.name_e,t.form.logo=e.logo,t.form.qrcode=e.qrcode,t.hasProduct=!!e.has_product,t.form.is_third=e.is_third,t.form.third_info=e.third_info})},handleLogoSuccess:function(e){if(200===e.code){var t=r()({},e.result);t.url=t.file_url,this.form.logo=t}else this.$message.error(e.msg)},handleQrSuccess:function(e){if(200===e.code){var t=r()({},e.result);t.url=t.file_url,this.form.qrcode=t}else this.$message.error(e.msg)},beforeLogoUpload:function(e){var t="image/png"===e.type,o=e.size/1024/1024<5;return t||this.$message.error("请上传5M大小内PNG格式的logo"),o||this.$message.error("请上传5M大小内PNG格式的logo"),t&&o},beforeQrUpload:function(e){var t=e.size/1024/1024<5;return t||this.$message.error("请上传5M大小内的二维码图标"),t},editChannel:function(){var t=this;if(this.disabled)return this.editText="确认并提交修改",this.disabled=!1;this.$refs.ruleForm.validate(function(e){if(e){if(""==t.form.logo.url||""==t.form.qrcode.url)return void t.$message.error("请上传渠道商logo和二维码！");t.$confirm("是否确认保存修改后渠道商信息？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:"/distributor/edit",method:"post",data:t.form}).then(function(e){t.disabled=!0,t.editText="编辑渠道商信息",t.$message({type:"success",message:"保存成功!"})}).catch(function(e){t.$message({type:"error",message:e.msg})})})}})},addChannel:function(){var t=this;this.$refs.ruleForm.validate(function(e){if(e){if(""==t.form.logo.url||""==t.form.qrcode.url)return void t.$message.error("请上传渠道商logo和二维码！");t.$confirm("是否确定添加该渠道商？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:"/distributor/add",method:"post",data:t.form}).then(function(e){t.$message({type:"success",message:"保存成功!"}),setTimeout(function(){t.$router.push({path:"/typeManagement/channelManager"})},2e3)}).catch(function(e){t.$message({type:"error",message:e.msg})})})}})},handleDelEvent:function(){var e=this;this.$confirm("是否确认删除此渠道商，删除不能恢复。","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.deleteChannel()}).catch(function(){})},deleteChannel:function(){var t=this;Object(s.a)({url:"/distributor/delete",method:"post",data:{id:this.form.id}}).then(function(e){e&&(t.$message.info("删除成功！"),t.$router.push({path:"/typeManagement/channelManager"}))}).catch(function(e){})},handleBackEvent:function(){this.$router.push({path:"/typeManagement/channelManager"})}}},d={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"app-container calendar-list-container addCategoryPage"},[o("el-row",{attrs:{gutter:30}},[o("el-col",{attrs:{span:24}},[o("el-button",{attrs:{type:"ghost"},on:{click:t.handleBackEvent}},[t._v("返回")]),t._v(" "),t.isEdit?t._e():o("el-button",{attrs:{type:"primary"},on:{click:t.addChannel}},[t._v("确定并添加该渠道商")]),t._v(" "),t.isEdit?o("el-button",{attrs:{type:"primary"},on:{click:t.editChannel}},[t._v(t._s(t.editText))]):t._e(),t._v(" "),t.isEdit&&!t.hasProduct?o("el-button",{attrs:{type:"danger"},on:{click:t.handleDelEvent}},[t._v("删除该渠道商")]):t._e()],1),t._v(" "),o("el-col",{staticStyle:{margin:"20px 0px","padding-bottom":"40px"},attrs:{span:24}},[o("div",{staticClass:"desTitleTop"},[t._v("基本信息")]),t._v(" "),o("el-col",{attrs:{span:24}},[o("el-form",{ref:"ruleForm",staticStyle:{"margin-top":"20px"},attrs:{rules:t.rules,model:t.form,"label-width":"80px",size:"large"}},[o("el-form-item",{attrs:{label:"序号","label-width":"120px",prop:"sort"}},[o("el-col",{attrs:{span:12}},[o("el-input",{attrs:{span:6,disabled:t.disabled||t.hasProduct,placeholder:" 请输入序号"},model:{value:t.form.sort,callback:function(e){t.$set(t.form,"sort",e)},expression:"form.sort"}})],1)],1),t._v(" "),o("el-form-item",{attrs:{label:"渠道商名称","label-width":"120px",prop:"name"}},[o("el-col",{attrs:{span:12}},[o("el-input",{attrs:{span:6,disabled:t.disabled||t.hasProduct,placeholder:" 中文名限中文、字母、32个字符、区分大小写"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1),t._v(" "),o("el-form-item",{attrs:{label:"渠道商英文","label-width":"120px",prop:"name_e"}},[o("el-col",{attrs:{span:12}},[o("el-input",{attrs:{disabled:t.disabled||t.hasProduct,span:6,placeholder:" 字母、下划线, 最多32个字符，区分大小写"},model:{value:t.form.name_e,callback:function(e){t.$set(t.form,"name_e",e)},expression:"form.name_e"}})],1)],1),t._v(" "),o("el-form-item",{staticStyle:{"padding-bottom":"30px"},attrs:{label:"渠道商logo","label-width":"120px"}},[o("el-col",{attrs:{span:12}},[o("p",{staticClass:"ttips"},[t._v("图标要求格式png，logo以外区域透明，大小5M以内")]),t._v(" "),o("div",{staticClass:"fileuploadItem channel"},[o("el-upload",{staticClass:"avatar-uploader",class:t.disabled?"disabled":"",attrs:{"show-file-list":!1,"on-success":t.handleLogoSuccess,"before-upload":t.beforeLogoUpload,disabled:t.disabled,data:t.logo,action:"/api/index.php/files/save",accept:"image/png"}},[""!=t.form.logo.url?o("img",{staticClass:"avatar",attrs:{src:t.form.logo.url}}):o("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)])],1),t._v(" "),o("el-form-item",{staticStyle:{"padding-bottom":"30px"},attrs:{label:"二维码","label-width":"120px"}},[o("el-col",{attrs:{span:12}},[o("p",{staticClass:"ttips"},[t._v("图标要求格式png、jpg、jpeg、gif、bmp，大小5M以内")]),t._v(" "),o("div",{staticClass:"fileuploadItem channel"},[o("el-upload",{staticClass:"avatar-uploader",class:t.disabled?"disabled":"",attrs:{"show-file-list":!1,"on-success":t.handleQrSuccess,"before-upload":t.beforeQrUpload,disabled:t.disabled,data:t.qrcode,action:"/api/index.php/files/save",accept:"image/*"}},[""!=t.form.qrcode.url?o("img",{staticClass:"avatar",attrs:{src:t.form.qrcode.url}}):o("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)])],1),t._v(" "),o("el-form-item",{staticStyle:{"padding-bottom":"30px"},attrs:{label:"是否第三方","label-width":"120px"}},[o("el-col",{attrs:{span:12}},[o("el-radio",{attrs:{label:1,disabled:t.disabled},on:{change:t.radioChange},model:{value:t.form.is_third,callback:function(e){t.$set(t.form,"is_third",e)},expression:"form.is_third"}},[t._v("是")]),t._v(" "),o("el-radio",{attrs:{label:0,disabled:t.disabled},on:{change:t.radioChange},model:{value:t.form.is_third,callback:function(e){t.$set(t.form,"is_third",e)},expression:"form.is_third"}},[t._v("否")])],1)],1),t._v(" "),t.form.is_third?o("el-form-item",{staticStyle:{"padding-bottom":"30px"},attrs:{label:"第三方简介","label-width":"120px"}},[o("el-col",{attrs:{span:12}},[o("el-input",{attrs:{type:"textarea",disabled:t.disabled,rows:2,max:32,placeholder:"内容不限字符，32个字符，区别大小写"},model:{value:t.form.third_info,callback:function(e){t.$set(t.form,"third_info",e)},expression:"form.third_info"}})],1)],1):t._e()],1)],1)],1)],1)],1)},staticRenderFns:[]};var u=o("VU/8")(l,d,!1,function(e){o("ukC4")},null,null);t.default=u.exports},E4LH:function(e,t,o){"use strict";t.a=function(e){return/^(\w-*\.*)+@(\w-?)+(\.\w{2,})+$/g.test(e)},t.c=function(e,t,o){var a=!0;if(!t)return void o();for(var r=0;r<t.length;r++){var s=t.charCodeAt(r);if(!(65<=s&&s<=90||97<=s&&s<=122||95==s)){a=!1,o("只能是字母下划线");break}}a&&o()},t.b=function(e,t,o){var a=!0;if(!t)return void o();for(var r=0;r<t.length;r++){var s=t.charAt(r);if(!/[\u4e00-\u9fa5a-zA-Z]+/g.test(s)){a=!1,o("只能是中文字母");break}}a&&o()}},WUXI:function(e,t){throw new Error("Module build failed: Error: Missing binding /Users/eric/PomeloHomeOpen_Sys/node_modules/node-sass/vendor/darwin-x64-57/binding.node\nNode Sass could not find a binding for your current environment: OS X 64-bit with Node.js 8.x\n\nFound bindings for the following environments:\n  - OS X 64-bit with Node.js 10.x\n\nThis usually happens because your environment has changed since running `npm install`.\nRun `npm rebuild node-sass` to download the binding for your current environment.\n    at module.exports (/Users/eric/PomeloHomeOpen_Sys/node_modules/node-sass/lib/binding.js:15:13)\n    at Object.<anonymous> (/Users/eric/PomeloHomeOpen_Sys/node_modules/node-sass/lib/index.js:14:35)\n    at Module._compile (module.js:653:30)\n    at Object.Module._extensions..js (module.js:664:10)\n    at Module.load (module.js:566:32)\n    at tryModuleLoad (module.js:506:12)\n    at Function.Module._load (module.js:498:3)\n    at Module.require (module.js:597:17)\n    at require (internal/module.js:11:18)\n    at Object.<anonymous> (/Users/eric/PomeloHomeOpen_Sys/node_modules/sass-loader/lib/loader.js:3:14)\n    at Module._compile (module.js:653:30)\n    at Object.Module._extensions..js (module.js:664:10)\n    at Module.load (module.js:566:32)\n    at tryModuleLoad (module.js:506:12)\n    at Function.Module._load (module.js:498:3)\n    at Module.require (module.js:597:17)")},ukC4:function(e,t,o){var a=o("WUXI");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);o("rjj0")("7066f7a0",a,!0)}});