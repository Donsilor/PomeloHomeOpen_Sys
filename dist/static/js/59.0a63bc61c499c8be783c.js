webpackJsonp([59],{"14/0":function(t,e,i){"use strict";function s(t){i("y5q7")}Object.defineProperty(e,"__esModule",{value:!0});var n=i("H5Fr"),a=i("VUng"),o=i("VU/8"),l=s,r=o(n.a,a.a,!1,l,"data-v-6a7455ee",null);e.default=r.exports},H5Fr:function(t,e,i){"use strict";var s=i("woOf"),n=i.n(s),a=i("Vo7i");e.a={data:function(){return{list:null,total:null,listLoading:!1,listQuery:{page:1,limit:15},formVisible:!1,isEdit:!1,typeList:[],formItem:{cid:"",event_name:"",push_rights:"",push_time:[],push_type:"",des:""}}},computed:{dialogTitle:function(){return this.isEdit?"edit event msg":"add event msg"}},created:function(){},mounted:function(){this.refresh()},methods:{refresh:function(){this.getList(),this.getTypeList()},getTypeList:function(){var t=this;Object(a.a)({url:"product/parenttype_lists",method:"POST"}).then(function(e){t.typeList=e.list})},getList:function(){var t=this;this.listLoading=!0;var e={limit:this.listQuery.limit,page:this.listQuery.page};Object(a.a)({url:"event/lists",data:e}).then(function(e){t.list=e.data,t.total=e.total_page,t.listLoading=!1})},handleSizeChange:function(t){this.listQuery.limit=t,this.getList()},handleCurrentChange:function(t){this.listQuery.page=t,this.getList()},addEventMsg:function(){this.isEdit=!1,this.formVisible=!0,this.formItem={push_time:[[]]}},editEventMsg:function(t,e){this.isEdit=!0,this.formVisible=!0,console.log(t.push_time),this.formItem=n()({},t,{push_time:this.setFormatTime(JSON.parse(t.push_time))})},setFormatTime:function(t){return t.map(function(t){return t.map(function(t){return t+="",t.indexOf(":")>0?t:(t>10?t:"0"+t)+":00"})})},getFormatTime:function(t){return t.map(function(t){return t.map(function(t){return t.indexOf(":")>0?parseInt(t.split(":")[0]):t})})},onSubmit:function(){var t=this,e=n()({},this.formItem,{push_time:this.getFormatTime(this.formItem.push_time),created_at:void 0,updated_at:void 0});Object(a.a)({url:this.isEdit?"event/edit":"event/add",method:"post",data:e}).then(function(e){t.$message.success("操作成功！"),t.formVisible=!1,t.getList()})},deleteRow:function(t){this.formItem.push_time.splice(t,1)},addRow:function(){this.formItem.push_time.push([])},getTypeTextById:function(t){var e=this.typeList.filter(function(e){return e.id===t});return e.length?e[0].name:t},getPushRightsText:function(t){return{0:"全员",1:"户主"}[t]},getTimeSelectOption:function(){return{start:"00:00",end:"23:00",step:"01:00"}}}}},KZgb:function(t,e,i){e=t.exports=i("FZ+f")(!0),e.push([t.i,".push_time_item[data-v-6a7455ee]{margin-bottom:5px}.hour[data-v-6a7455ee]{width:100px}","",{version:3,sources:["D:/work/PomeloHomeOpen_Sys/src/views/configManagement/eventMsg.vue"],names:[],mappings:"AACA,iCACE,iBAAmB,CACpB,AACD,uBACE,WAAa,CACd",file:"eventMsg.vue",sourcesContent:["\n.push_time_item[data-v-6a7455ee] {\r\n  margin-bottom: 5px;\n}\n.hour[data-v-6a7455ee] {\r\n  width: 100px;\n}\r\n"],sourceRoot:""}])},VUng:function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container calendar-list-container"},[i("el-row",{staticStyle:{"margin-bottom":"10px"}},[i("el-button",{attrs:{size:"medium",type:"primary"},on:{click:t.addEventMsg}},[t._v("\n      新增事件\n    ")])],1),t._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:t.list,"element-loading-text":"给我一点时间",stripe:"",fit:"","highlight-current-row":""}},[i("el-table-column",{attrs:{align:"center",label:"事件名称",prop:"event_name"}}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"品类"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.getTypeTextById(e.row.cid)))]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"push_rights"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.getPushRightsText(e.row.push_rights)))]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"push_time",prop:"push_time"}}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"push_type",prop:"push_type"}}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"des",prop:"des"}}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(i){t.editEventMsg(e.row,!0)}}},[t._v("\n          编辑\n        ")])]}}])})],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.listLoading,expression:"!listLoading"}],staticClass:"pagination-container"},[i("el-pagination",{attrs:{"current-page":t.listQuery.page,"page-sizes":[15,20,30,50],"page-size":t.listQuery.limit,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.$set(t.listQuery,"page",e)}}})],1),t._v(" "),i("el-dialog",{attrs:{visible:t.formVisible,title:t.dialogTitle},on:{"update:visible":function(e){t.formVisible=e}}},[i("el-form",{attrs:{"label-width":"120px"}},[i("el-form-item",{attrs:{label:"品类"}},[i("el-select",{attrs:{disabled:t.isEdit},model:{value:t.formItem.cid,callback:function(e){t.$set(t.formItem,"cid",e)},expression:"formItem.cid"}},t._l(t.typeList,function(t){return i("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})}))],1),t._v(" "),i("el-form-item",{attrs:{label:"事件名称"}},[i("el-input",{attrs:{disabled:t.isEdit},model:{value:t.formItem.event_name,callback:function(e){t.$set(t.formItem,"event_name",e)},expression:"formItem.event_name"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"push_rights"}},[i("el-select",{model:{value:t.formItem.push_rights,callback:function(e){t.$set(t.formItem,"push_rights",e)},expression:"formItem.push_rights"}},[i("el-option",{attrs:{label:"全员",value:0}}),t._v(" "),i("el-option",{attrs:{label:"户主",value:1}})],1)],1),t._v(" "),i("el-form-item",{attrs:{label:"push_time"}},[t._l(t.formItem.push_time,function(e,s){return i("div",{key:s,staticClass:"push_time_item"},[i("el-time-select",{staticClass:"hour",attrs:{clearable:!1,"picker-options":t.getTimeSelectOption(s,0)},model:{value:t.formItem.push_time[s][0],callback:function(e){t.$set(t.formItem.push_time[s],0,e)},expression:"formItem.push_time[index][0]"}}),t._v(" -\n          "),i("el-time-select",{staticClass:"hour",attrs:{clearable:!1,"picker-options":t.getTimeSelectOption(s,1)},model:{value:t.formItem.push_time[s][1],callback:function(e){t.$set(t.formItem.push_time[s],1,e)},expression:"formItem.push_time[index][1]"}}),t._v(" "),t.formItem.push_time.length>1?i("i",{staticClass:"el-icon-remove",on:{click:function(e){t.deleteRow(s)}}}):t._e()],1)}),t._v(" "),i("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus",size:"mini"},on:{click:t.addRow}},[t._v("新增一行")])],2),t._v(" "),i("el-form-item",{attrs:{label:"push_type"}},[i("el-input",{model:{value:t.formItem.push_type,callback:function(e){t.$set(t.formItem,"push_type",e)},expression:"formItem.push_type"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"des"}},[i("el-input",{attrs:{type:"textarea",rows:"2"},model:{value:t.formItem.des,callback:function(e){t.$set(t.formItem,"des",e)},expression:"formItem.des"}}),t._v(" "),i("span",[t._v("支持标签：${family_name},${room_name},${device_name}")])],1)],1),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("提交")]),t._v(" "),i("el-button",{on:{click:function(e){t.formVisible=!1}}},[t._v("取消")])],1)],1)],1)},n=[],a={render:s,staticRenderFns:n};e.a=a},y5q7:function(t,e,i){var s=i("KZgb");"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);i("rjj0")("fc4888e4",s,!0)}});
//# sourceMappingURL=59.0a63bc61c499c8be783c.js.map